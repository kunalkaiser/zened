<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZenEd ‚Äî Your grades. Your plan. Your future.</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,100..900;1,9..144,100..900&family=Instrument+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --ink:   #0d0d0d;
  --white: #ffffff;
  --soft:  #f6f6f4;
  --line:  #e8e8e5;
  --muted: #6b7280;
  --green: #00a86b;
  --green2:#007a4d;
  --glite: #e6f6ef;
  --red:   #dc2626;
  --amber: #d97706;
}
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
html { scroll-behavior:smooth; }
body {
  font-family: 'Instrument Sans', sans-serif;
  background: #fff;
  color: var(--ink);
  -webkit-font-smoothing: antialiased;
}

/* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
nav {
  height: 58px; padding: 0 36px;
  display: flex; align-items: center; justify-content: space-between;
  border-bottom: 1px solid var(--line);
  background: #fff; position: sticky; top: 0; z-index: 200;
}
.logo { display:flex; align-items:center; gap:9px; text-decoration:none; color:var(--ink); }
.logo-ico {
  width: 30px; height: 30px;
  background: var(--green);
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  color: #fff; font-size: 14px; font-weight: 900;
  font-family: 'Fraunces', serif; font-style: italic;
  flex-shrink: 0;
}
.logo-word {
  font-family: 'Fraunces', serif; font-weight: 900;
  font-size: 19px; letter-spacing: -0.4px;
}
.logo-word em { color: var(--green); font-style: italic; }
.nav-right { display:flex; gap:6px; align-items:center; }
.nav-link {
  font-size: 13px; font-weight: 500; color: var(--muted);
  text-decoration: none; padding: 6px 10px; border-radius: 8px;
  transition: color .15s;
}
.nav-link:hover { color: var(--ink); }
.nav-signin {
  font-size: 13px; font-weight: 600; color: var(--ink);
  border: 1.5px solid var(--ink);
  padding: 6px 18px; border-radius: 100px;
  text-decoration: none; transition: all .15s;
}
.nav-signin:hover { background: var(--ink); color: #fff; }
.btn-support-nav {
  display: inline-flex; align-items: center; gap: 5px;
  background: #FFDD00; color: #000;
  font-size: 12px; font-weight: 700;
  padding: 5px 13px; border-radius: 100px;
  text-decoration: none; white-space: nowrap;
  transition: background .15s;
}
.btn-support-nav:hover { background: #f0d000; }

/* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
.hero {
  text-align: center;
  padding: 52px 24px 28px;
  max-width: 680px; margin: 0 auto;
}
@keyframes fadeUp {
  from { opacity:0; transform:translateY(12px); }
  to   { opacity:1; transform:translateY(0); }
}
.hero-badge {
  display: inline-flex; align-items: center; gap: 7px;
  border: 1px solid var(--line);
  padding: 5px 16px; border-radius: 100px;
  font-size: 12px; font-weight: 500; color: var(--muted);
  margin-bottom: 24px; animation: fadeUp .4s ease;
}
.hero-badge-dot { width:6px; height:6px; background:var(--green); border-radius:50%; }
.hero-title {
  font-family: 'Fraunces', serif;
  font-size: clamp(52px, 10vw, 80px);
  font-weight: 900; line-height: .95;
  letter-spacing: -3px; margin-bottom: 18px;
  animation: fadeUp .4s .06s ease both;
}
.hero-title em { font-style: italic; color: var(--green); }
.hero-sub {
  font-size: 16px; color: var(--muted); line-height: 1.6;
  animation: fadeUp .4s .12s ease both;
}

/* ‚îÄ‚îÄ GOAL SECTION ‚îÄ‚îÄ */
.goal-section {
  max-width: 700px; margin: 0 auto;
  padding: 0 20px 32px;
  animation: fadeUp .4s .18s ease both;
}
.step-label {
  text-align: center;
  font-size: 11px; font-weight: 700;
  letter-spacing: 1.4px; text-transform: uppercase;
  color: var(--muted); margin: 28px 0 14px;
}
.goal-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px; margin-bottom: 24px;
}
.goal-card {
  background: #fff; border: 1.5px solid var(--line);
  border-radius: 14px; padding: 20px 16px;
  cursor: pointer; text-align: left; position: relative;
  transition: border-color .15s, box-shadow .15s;
  display: flex; flex-direction: column;
}
.goal-card:hover {
  border-color: var(--ink);
  box-shadow: 0 2px 12px rgba(0,0,0,.06);
}
.goal-card.selected { border-color: var(--green); background: var(--glite); }
.goal-card-check {
  position: absolute; top: 12px; right: 12px;
  width: 20px; height: 20px;
  background: var(--green); border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  color: #fff; font-size: 10px; font-weight: 800;
  opacity: 0; transition: opacity .15s;
}
.goal-card.selected .goal-card-check { opacity: 1; }
.goal-icon { font-size: 24px; margin-bottom: 10px; }
.goal-title { font-size: 13px; font-weight: 700; color: var(--ink); margin-bottom: 4px; }
.goal-desc  { font-size: 11px; color: var(--muted); line-height: 1.5; flex: 1; }

/* ‚îÄ‚îÄ CTA ‚îÄ‚îÄ */
.cta-wrap { text-align: center; }
.btn-go {
  display: inline-flex; align-items: center; gap: 8px;
  background: var(--ink); color: #fff;
  padding: 14px 38px; border-radius: 100px;
  font-size: 15px; font-weight: 700; cursor: pointer;
  border: none; font-family: 'Instrument Sans', sans-serif;
  letter-spacing: -.2px; transition: all .15s;
}
.btn-go:hover { background: #222; transform: translateY(-1px); }
.btn-go:disabled { opacity: .25; cursor: not-allowed; transform: none; }
.cta-note { font-size: 12px; color: var(--muted); margin-top: 10px; }

/* ‚îÄ‚îÄ DIVIDER ‚îÄ‚îÄ */
.divider { max-width: 560px; margin: 0 auto; height: 1px; background: var(--line); }

/* ‚îÄ‚îÄ FLOW SCREENS ‚îÄ‚îÄ */
.flow-section { max-width: 580px; margin: 0 auto; padding: 0 20px; }
@keyframes slideIn {
  from { opacity:0; transform:translateY(12px); }
  to   { opacity:1; transform:translateY(0); }
}
.flow-screen { display:none; animation: slideIn .22s ease; }
.flow-screen.active { display:block; }

/* ‚îÄ‚îÄ PROGRESS BAR ‚îÄ‚îÄ */
.progress-wrap { margin-bottom: 24px; }
.progress-bar { height: 2px; background: var(--line); border-radius: 2px; overflow: hidden; }
.progress-fill { height:100%; background:var(--ink); border-radius:2px; transition:width .4s ease; }
.progress-label { font-size: 11px; color: var(--muted); margin-top: 7px; font-weight: 500; }

/* ‚îÄ‚îÄ BACK / NEXT ‚îÄ‚îÄ */
.btn-back-flow {
  display: flex; align-items: center; gap: 5px;
  background: none; border: none; cursor: pointer;
  font-family: 'Instrument Sans', sans-serif;
  font-size: 13px; font-weight: 600; color: var(--muted);
  padding: 0; margin-bottom: 22px; transition: color .15s;
}
.btn-back-flow:hover { color: var(--ink); }
.btn-next {
  display: inline-flex; align-items: center; gap: 8px;
  background: var(--ink); color: #fff;
  padding: 12px 28px; border-radius: 100px;
  font-size: 14px; font-weight: 700; cursor: pointer;
  border: none; font-family: 'Instrument Sans', sans-serif;
  transition: all .15s;
}
.btn-next:hover { background: #222; }
.btn-next:disabled { opacity: .25; cursor: not-allowed; }

/* ‚îÄ‚îÄ SUBJECT GRID ‚îÄ‚îÄ */
.subj-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(130px,1fr));
  gap: 8px; margin-bottom: 24px;
}
.subj-card {
  background: #fff; border: 1.5px solid var(--line);
  border-radius: 12px; padding: 15px; cursor: pointer;
  transition: border-color .15s; text-align: left; position: relative;
}
.subj-card:hover { border-color: var(--ink); }
.subj-card.selected { border-color: var(--green); background: var(--glite); }
.subj-card-check {
  position: absolute; top: 9px; right: 9px;
  width: 16px; height: 16px; background: var(--green);
  border-radius: 50%; display: flex; align-items: center;
  justify-content: center; color: #fff; font-size: 9px;
  opacity: 0; transition: opacity .15s;
}
.subj-card.selected .subj-card-check { opacity: 1; }
.subj-icon { font-size: 20px; margin-bottom: 6px; }
.subj-name { font-size: 12px; font-weight: 700; }

/* ‚îÄ‚îÄ SCORE INPUT ‚îÄ‚îÄ */
.score-wrap {
  background: #fff; border-radius: 14px;
  border: 1.5px solid var(--line); padding: 28px; margin-bottom: 20px;
}
.score-subj-name {
  font-family: 'Fraunces', serif; font-size: 22px;
  font-weight: 900; margin-bottom: 4px; letter-spacing: -.5px;
}
.score-counter { font-size: 13px; color: var(--muted); margin-bottom: 20px; }
.score-input {
  width: 100%; font-family: 'Fraunces', serif;
  font-size: 68px; font-weight: 900; text-align: center;
  border: none; outline: none; color: var(--ink);
  background: transparent; margin-bottom: 8px; letter-spacing: -4px;
}
.score-hint { text-align: center; font-size: 12px; color: var(--muted); margin-bottom: 20px; }
.quickpicks { display: flex; gap: 6px; justify-content: center; flex-wrap: wrap; }
.qp {
  padding: 6px 14px; border: 1.5px solid var(--line); border-radius: 100px;
  font-size: 12px; font-weight: 700; cursor: pointer;
  background: #fff; font-family: 'Instrument Sans', sans-serif;
  color: var(--muted); transition: all .15s;
}
.qp:hover { border-color: var(--ink); color: var(--ink); }
.qp.on { background: var(--ink); color: #fff; border-color: var(--ink); }

/* ‚îÄ‚îÄ RESULT HERO ‚îÄ‚îÄ */
.result-hero { text-align: center; margin-bottom: 24px; }
.result-emoji { font-size: 44px; margin-bottom: 10px; }
.result-title {
  font-family: 'Fraunces', serif; font-size: 30px;
  font-weight: 900; letter-spacing: -1px; margin-bottom: 6px;
}
.result-sub { font-size: 14px; color: var(--muted); line-height: 1.6; }

/* ‚îÄ‚îÄ RESULT CARDS ‚îÄ‚îÄ */
.rcard {
  display: flex; align-items: center; justify-content: space-between;
  background: #fff; border: 1.5px solid var(--line);
  border-left: 4px solid var(--line);
  border-radius: 12px; padding: 15px 18px; margin-bottom: 8px;
}
.rcard.green { border-left-color: var(--green); background: #f0fdf8; }
.rcard.yellow{ border-left-color: var(--amber); background: #fffbeb; }
.rcard.red   { border-left-color: var(--red);   background: #fef2f2; }
.rcard-subj  { font-size: 14px; font-weight: 700; margin-bottom: 2px; }
.rcard-status{ font-size: 12px; font-weight: 600; margin-bottom: 2px; }
.rcard.green .rcard-status { color: var(--green); }
.rcard.yellow .rcard-status{ color: var(--amber); }
.rcard.red   .rcard-status { color: var(--red);   }
.rcard-action{ font-size: 11px; color: var(--muted); }
.rcard-score {
  font-family: 'Fraunces', serif; font-size: 40px;
  font-weight: 900; letter-spacing: -2px; flex-shrink: 0;
}
.rcard.green .rcard-score { color: var(--green); }
.rcard.yellow .rcard-score{ color: var(--amber); }
.rcard.red   .rcard-score { color: var(--red);   }

/* ‚îÄ‚îÄ PANELS ‚îÄ‚îÄ */
.panel {
  background: #fff; border: 1.5px solid var(--line);
  border-radius: 14px; padding: 20px; margin-bottom: 12px;
}
.panel-title {
  font-size: 11px; font-weight: 700; text-transform: uppercase;
  letter-spacing: .8px; color: var(--muted); margin-bottom: 14px;
}
.study-item { display: flex; gap: 10px; margin-bottom: 14px; align-items: flex-start; }
.sdot { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; margin-top: 5px; }
.sdot.red    { background: var(--red);   }
.sdot.yellow { background: var(--amber); }
.sdot.green  { background: var(--green); }
.study-name { font-size: 13px; font-weight: 600; margin-bottom: 3px; }
.study-link { font-size: 12px; color: var(--green); font-weight: 600; text-decoration: none; }
.study-link:hover { text-decoration: underline; }

/* ‚îÄ‚îÄ RESOURCE BROWSER ‚îÄ‚îÄ */
.res-browser {
  background: #fff; border: 1.5px solid var(--line);
  border-radius: 14px; overflow: hidden; margin-bottom: 12px;
}
.res-browser-head {
  display: flex; align-items: center; justify-content: space-between;
  padding: 18px 18px 0;
}
.res-browser-label {
  font-size: 11px; font-weight: 700; text-transform: uppercase;
  letter-spacing: .8px; color: var(--green); margin-bottom: 3px;
}
.res-browser-title {
  font-family: 'Fraunces', serif; font-size: 17px;
  font-weight: 900; letter-spacing: -.4px;
}
.res-see-all {
  font-size: 12px; font-weight: 600; color: var(--ink);
  border: 1.5px solid var(--line); padding: 5px 12px;
  border-radius: 100px; text-decoration: none;
  transition: border-color .15s; white-space: nowrap;
}
.res-see-all:hover { border-color: var(--ink); }
.res-pills {
  display: flex; gap: 6px; overflow-x: auto; padding: 10px 18px 0;
  scrollbar-width: none;
}
.res-pills::-webkit-scrollbar { display: none; }
.res-pill {
  padding: 4px 12px; border-radius: 100px; font-size: 12px;
  font-weight: 600; cursor: pointer; border: 1.5px solid var(--line);
  background: #fff; color: var(--muted); white-space: nowrap;
  font-family: 'Instrument Sans', sans-serif;
  transition: all .15s; flex-shrink: 0;
}
.res-pill:hover { border-color: var(--ink); color: var(--ink); }
.res-pill.active { background: var(--ink); color: #fff; border-color: var(--ink); }
.res-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; padding: 10px 18px; }
.rc {
  background: var(--soft); border-radius: 10px; padding: 12px;
  text-decoration: none; color: var(--ink); display: block;
  transition: all .15s; border: 1.5px solid transparent;
}
.rc:hover { border-color: var(--ink); background: #fff; }
.rc-icon { font-size: 18px; margin-bottom: 6px; }
.rc-name { font-size: 12px; font-weight: 600; line-height: 1.3; margin-bottom: 5px; }
.rc-tags { display: flex; gap: 4px; flex-wrap: wrap; }
.rc-tag  { font-size: 10px; font-weight: 700; padding: 2px 7px; border-radius: 100px; }
.rc-tag.free { background: #e6f6ef; color: #006644; }
.rc-tag.paid { background: #fef3c7; color: #b45309; }
.rc-tag.stem { background: #eff6ff; color: #2563eb; }
.rc-tag.hot  { background: #fef2f2; color: #dc2626; }
.res-full-btn {
  display: block; margin: 0 18px 16px;
  padding: 10px; text-align: center;
  background: var(--ink); color: #fff;
  border-radius: 100px; font-size: 13px; font-weight: 700;
  text-decoration: none; transition: background .15s;
}
.res-full-btn:hover { background: #222; }

/* ‚îÄ‚îÄ SIGNUP CTA ‚îÄ‚îÄ */
.save-cta {
  background: var(--ink); border-radius: 16px;
  padding: 30px 26px; text-align: center; color: #fff; margin-bottom: 12px;
}
.save-cta-badge {
  display: inline-block; background: rgba(255,255,255,.1);
  color: #a3e6cb; font-size: 11px; font-weight: 700;
  padding: 4px 12px; border-radius: 100px; margin-bottom: 12px;
  letter-spacing: .5px; text-transform: uppercase;
}
.save-cta h2 {
  font-family: 'Fraunces', serif; font-size: 25px;
  font-weight: 900; margin-bottom: 8px; letter-spacing: -.8px;
}
.save-cta p { font-size: 13px; color: #9ca3af; line-height: 1.7; margin-bottom: 20px; }
.save-benefits {
  display: grid; grid-template-columns: 1fr 1fr;
  gap: 8px; margin-bottom: 20px; text-align: left;
}
.save-benefit {
  background: rgba(255,255,255,.07); border-radius: 10px;
  padding: 10px 12px; font-size: 12px; color: #d1d5db;
  display: flex; align-items: center; gap: 8px;
}
.save-benefit-icon { font-size: 15px; flex-shrink: 0; }
.btn-signup {
  display: block; background: var(--green); color: #fff;
  padding: 13px 28px; border-radius: 100px; font-size: 14px;
  font-weight: 700; text-decoration: none; margin-bottom: 10px;
  transition: background .15s;
}
.btn-signup:hover { background: var(--green2); }
.btn-skip { font-size: 12px; color: #6b7280; text-decoration: none; }

/* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
footer {
  padding: 28px 36px; border-top: 1px solid var(--line);
  background: #fff; display: flex; align-items: center;
  justify-content: space-between; flex-wrap: wrap; gap: 14px;
  margin-top: 80px;
}
.footer-links { display: flex; gap: 18px; }
.footer-links a {
  font-size: 12px; color: var(--muted);
  text-decoration: none; font-weight: 500;
}
.footer-links a:hover { color: var(--ink); }

/* ‚îÄ‚îÄ MOBILE ‚îÄ‚îÄ */
@media (max-width: 540px) {
  nav { padding: 0 16px; }
  .nav-link { display: none; }
  .hero { padding: 40px 16px 20px; }
  .hero-title { letter-spacing: -2px; }
  .goal-section { padding: 0 16px 28px; }
  .goal-grid { grid-template-columns: 1fr 1fr; gap: 8px; }
  .goal-card { padding: 16px 13px; }
  .goal-icon { font-size: 20px; }
  .goal-title { font-size: 12px; }
  .goal-desc  { display: none; }
  .save-benefits { grid-template-columns: 1fr; }
  .res-grid { grid-template-columns: 1fr; }
  .flow-section { padding: 0 14px; }
  footer { padding: 20px 16px; flex-direction: column; align-items: flex-start; }
}
@media (max-width: 380px) {
  .hero-title { font-size: 44px; }
  .btn-go { padding: 13px 28px; font-size: 14px; }
}
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <a href="index.html" class="logo">
    <div class="logo-ico">
      <svg viewBox="0 0 24 24" fill="none" width="14" height="14">
        <path d="M12 3L4 8V16L12 21L20 16V8L12 3Z" stroke="white" stroke-width="1.8" stroke-linejoin="round"/>
        <path d="M8 11L12 15L16 11" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M12 7V15" stroke="white" stroke-width="1.8" stroke-linecap="round"/>
      </svg>
    </div>
    <span class="logo-word">Zen<em>Ed</em></span>
  </a>
  <div class="nav-right">
    <a href="index.html" class="nav-link" id="nl-home">Home</a>
    <a href="practice.html" class="nav-link" id="nl-practice">Practice</a>
    <a href="resources.html" class="nav-link" id="nl-resources">Resources</a>
    <a href="dashboard.html" class="nav-link" id="nl-dashboard">Dashboard</a>
    <a href="mission.html" class="nav-link" id="nl-mission">Mission</a>
    <div class="nav-search-wrap" id="navSearchWrap">
      <button class="nav-search-btn" onclick="navSearchToggle()" aria-label="Search">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2.2" stroke-linecap="round"><circle cx="11" cy="11" r="7"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
      </button>
      <input class="nav-search-input" id="navSearchInput" type="text" placeholder="Search resources‚Ä¶" onkeydown="if(event.key==='Escape')navSearchClose()" oninput="navSearchRun(this.value)">
    <div class="nav-search-results" id="navSearchResults"></div>
    </div>
    <a href="https://ko-fi.com/zened" target="_blank" class="btn-support-nav">‚òï Support</a>
    <a href="app.html" class="nav-signin" id="navSigninBtn">Sign in</a>
  </div>
</nav>

<!-- ‚ïê‚ïê SCREEN 1: HERO + GOAL CARDS ‚ïê‚ïê -->
<div id="s1">
  <div class="hero">
    <div class="hero-badge"><span class="hero-badge-dot"></span>Free for every high school student</div>
    <h1 class="hero-title">Your grades.<br>Your <em>plan.</em><br>Your future.</h1>
    <p class="hero-sub">Pick what you need ‚Äî get instant answers. No login, no wait.</p>
  </div>

  <div class="flow-section">
    <div class="step-label">What do you need help with?</div>
    <div class="goal-grid" style="grid-template-columns:repeat(3,1fr);max-width:680px">
      <button class="goal-card" id="gc-regents" onclick="toggleGoal('regents',this)">
        <div class="goal-card-check">‚úì</div>
        <span class="goal-icon">üìù</span>
        <div class="goal-title">Passing my Regents</div>
        <div class="goal-desc">Check readiness by unit, get a study plan tonight</div>
      </button>
      <button class="goal-card" id="gc-sat" onclick="toggleGoal('sat',this)">
        <div class="goal-card-check">‚úì</div>
        <span class="goal-icon">üß™</span>
        <div class="goal-title">SAT / ACT Prep</div>
        <div class="goal-desc">Diagnostic + week-by-week free study plan</div>
      </button>
      <button class="goal-card" id="gc-college" onclick="toggleGoal('college',this)">
        <div class="goal-card-check">‚úì</div>
        <span class="goal-icon">üéì</span>
        <div class="goal-title">College admissions</div>
        <div class="goal-desc">CUNY, SUNY, deadlines, FAFSA, essays ‚Äî NY-first</div>
      </button>
      <button class="goal-card" id="gc-cte" onclick="toggleGoal('cte',this)">
        <div class="goal-card-check">‚úì</div>
        <span class="goal-icon">‚öôÔ∏è</span>
        <div class="goal-title">CTE pathways</div>
        <div class="goal-desc">Tech, Health, Business, Law ‚Äî jobs without a 4-year degree</div>
      </button>
      <button class="goal-card" id="gc-tutoring" onclick="toggleGoal('tutoring',this)">
        <div class="goal-card-check">‚úì</div>
        <span class="goal-icon">üìÑ</span>
        <div class="goal-title">Resume builder</div>
        <div class="goal-desc">Free resume for students with no work experience</div>
      </button>
      <button class="goal-card" id="gc-summer" onclick="toggleGoal('summer',this)">
        <div class="goal-card-check">‚úì</div>
        <span class="goal-icon">üóÇÔ∏è</span>
        <div class="goal-title">All resources</div>
        <div class="goal-desc">Internships, scholarships, labs, programs & more</div>
      </button>
    </div>
    <div class="cta-wrap">
      <button class="btn-go" id="startBtn" onclick="startFlow()" disabled>Let's go ‚Üí</button>
      <div class="cta-note">No account needed ¬∑ Results in 30 seconds ¬∑ Free</div>
      
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê FEATURES SECTION ‚ïê‚ïê -->

<!-- ‚ïê‚ïê SCREEN 2: SUBJECT PICKER ‚ïê‚ïê -->
<div class="flow-screen" id="s2">
  <div class="flow-section" style="padding-top:32px">
    <button class="btn-back-flow" onclick="goTo('s1')">‚Üê Back</button>
    <div class="progress-wrap">
      <div class="progress-bar"><div class="progress-fill" style="width:25%"></div></div>
      <div class="progress-label">Step 1 of 3 ‚Äî Pick your subject</div>
    </div>
    <div class="step-label">Which Regents are you taking?</div>
    <div class="subj-grid" id="subjGrid">
      <button class="subj-card" onclick="toggleSubj('biology',this)">
        <div class="subj-card-check">‚úì</div>
        <div class="subj-icon">üß¨</div>
        <div class="subj-name">Biology</div>
      </button>
      <button class="subj-card" onclick="toggleSubj('algebra',this)">
        <div class="subj-card-check">‚úì</div>
        <div class="subj-icon">üìê</div>
        <div class="subj-name">Algebra 1</div>
      </button>
      <button class="subj-card" onclick="toggleSubj('ela',this)">
        <div class="subj-card-check">‚úì</div>
        <div class="subj-icon">üìñ</div>
        <div class="subj-name">English ELA</div>
      </button>
      <button class="subj-card" onclick="toggleSubj('us_history',this)">
        <div class="subj-card-check">‚úì</div>
        <div class="subj-icon">üá∫üá∏</div>
        <div class="subj-name">US History</div>
      </button>
      <button class="subj-card" onclick="toggleSubj('shsat',this)">
        <div class="subj-card-check">‚úì</div>
        <div class="subj-icon">üè´</div>
        <div class="subj-name">SHSAT Prep</div>
      </button>
    </div>
    <div style="text-align:center">
      <button class="btn-next" id="s2Next" onclick="goS2b()" disabled>Pick units ‚Üí</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê SCREEN 2b: UNIT PICKER ‚ïê‚ïê -->
<div class="flow-screen" id="s2b">
  <div class="flow-section" style="padding-top:32px">
    <button class="btn-back-flow" onclick="goTo('s2')">‚Üê Back</button>
    <div class="progress-wrap">
      <div class="progress-bar"><div class="progress-fill" style="width:50%"></div></div>
      <div class="progress-label" id="s2bLabel">Step 2 of 3 ‚Äî Which units have you covered?</div>
    </div>
    <div class="step-label" id="s2bTitle"></div>
    <p style="font-size:13px;color:var(--gray);text-align:center;margin-bottom:16px">Pick the units you've been tested on or have grades for.</p>
    <div class="subj-grid" id="unitGrid"></div>
    <div style="text-align:center">
      <button class="btn-next" id="s2bNext" onclick="goS3()" disabled>Enter grades ‚Üí</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê SCREEN 3: GRADE INPUT ‚ïê‚ïê -->
<div class="flow-screen" id="s3">
  <div class="flow-section" style="padding-top:32px">
    <button class="btn-back-flow" onclick="prevUnit()">‚Üê Back</button>
    <div class="progress-wrap">
      <div class="progress-bar"><div class="progress-fill" id="pFill" style="width:75%"></div></div>
      <div class="progress-label" id="s3Sub">Step 3 of 3</div>
    </div>
    <div id="s3Card"></div>
    <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
      <button class="btn-back-flow" id="backBtn" onclick="prevUnit()" style="visibility:hidden">‚Üê Previous</button>
      <button class="btn-next" id="s3Next" onclick="nextUnit()">Next ‚Üí</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê SCREEN 4: RESULTS ‚ïê‚ïê -->
<!-- ‚ïê‚ïê SIGNUP MODAL ‚ïê‚ïê -->
<div id="signupModal" style="display:none;position:fixed;inset:0;z-index:1000;align-items:flex-end;justify-content:center">
  <div onclick="closeModal()" style="position:absolute;inset:0;background:rgba(0,0,0,0.55);backdrop-filter:blur(4px)"></div>
  <div style="position:relative;width:100%;max-width:480px;background:#0d0d0d;border-radius:24px 24px 0 0;padding:32px 28px 44px;animation:slideUp 0.3s ease">
    <button onclick="closeModal()" style="position:absolute;top:16px;right:16px;background:rgba(255,255,255,0.1);border:none;color:white;width:32px;height:32px;border-radius:50%;font-size:18px;cursor:pointer;display:flex;align-items:center;justify-content:center">x</button>
    <div id="authViewChoose">
      <div style="text-align:center;margin-bottom:22px">
        <div style="font-size:34px;margin-bottom:8px" id="modalEmoji">‚ú®</div>
        <div style="font-family:'Fraunces',serif;font-size:22px;font-weight:900;color:white;letter-spacing:-0.5px;margin-bottom:5px" id="modalTitle">Save your study plan</div>
        <div style="font-size:13px;color:#94a3b8;line-height:1.6" id="modalSub">Free account ‚Äî your plan is saved forever.</div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:20px">
        <div style="background:rgba(255,255,255,0.07);border-radius:10px;padding:10px 12px;font-size:12px;color:#cbd5e1;display:flex;align-items:center;gap:8px"><span>üìä</span>Scores saved and tracked</div>
        <div style="background:rgba(255,255,255,0.07);border-radius:10px;padding:10px 12px;font-size:12px;color:#cbd5e1;display:flex;align-items:center;gap:8px"><span>üéØ</span>Your study plan, always</div>
        <div style="background:rgba(255,255,255,0.07);border-radius:10px;padding:10px 12px;font-size:12px;color:#cbd5e1;display:flex;align-items:center;gap:8px"><span>‚è∞</span>Deadline reminders</div>
        <div style="background:rgba(255,255,255,0.07);border-radius:10px;padding:10px 12px;font-size:12px;color:#cbd5e1;display:flex;align-items:center;gap:8px"><span>üìÑ</span>Resume saved</div>
      </div>
      <button onclick="signInWithGoogle()" style="width:100%;padding:13px;background:white;color:#0d0d0d;border:none;border-radius:100px;font-size:14px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:10px;font-family:'Instrument Sans',sans-serif">
        <svg width="18" height="18" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.08 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.18 1.48-4.97 2.31-8.16 2.31-6.26 0-11.57-3.59-13.46-8.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/></svg>
        Continue with Google
      </button>
      <button onclick="showAuthEmail('signup')" style="width:100%;padding:13px;background:var(--green);color:white;border:none;border-radius:100px;font-size:14px;font-weight:700;cursor:pointer;margin-bottom:10px;font-family:'Instrument Sans',sans-serif">Sign up with email</button>
      <div style="text-align:center">
        <button onclick="showAuthEmail('login')" style="background:none;border:none;font-size:12px;color:#64748b;cursor:pointer;font-family:'Instrument Sans',sans-serif;text-decoration:underline">Already have an account? Sign in</button>
        <span style="color:#374151;margin:0 8px">¬∑</span>
        <button onclick="continueWithoutSaving()" style="background:none;border:none;font-size:12px;color:#64748b;cursor:pointer;font-family:'Instrument Sans',sans-serif;text-decoration:underline">Skip for now</button>
      </div>
    </div>
    <div id="authViewEmail" style="display:none">
      <div style="text-align:center;margin-bottom:18px">
        <div style="font-family:'Fraunces',serif;font-size:22px;font-weight:900;color:white;letter-spacing:-0.5px;margin-bottom:4px" id="authEmailTitle">Create your account</div>
        <div style="font-size:13px;color:#94a3b8">Free forever. No spam.</div>
      </div>
      <input id="authEmail" type="email" placeholder="your@email.com" autocomplete="email" style="width:100%;padding:13px 16px;background:rgba(255,255,255,0.08);border:1.5px solid rgba(255,255,255,0.12);border-radius:12px;color:white;font-size:14px;margin-bottom:10px;outline:none;font-family:'Instrument Sans',sans-serif;display:block;box-sizing:border-box">
      <input id="authPassword" type="password" placeholder="Password (min 6 characters)" autocomplete="new-password" style="width:100%;padding:13px 16px;background:rgba(255,255,255,0.08);border:1.5px solid rgba(255,255,255,0.12);border-radius:12px;color:white;font-size:14px;margin-bottom:10px;outline:none;font-family:'Instrument Sans',sans-serif;display:block;box-sizing:border-box">
      <div id="authError" style="display:none;background:rgba(220,38,38,0.15);border:1px solid rgba(220,38,38,0.3);border-radius:8px;padding:10px 14px;font-size:12px;color:#fca5a5;margin-bottom:10px"></div>
      <button id="authSubmitBtn" onclick="submitAuth()" data-mode="signup" style="width:100%;padding:13px;background:var(--green);color:white;border:none;border-radius:100px;font-size:14px;font-weight:700;cursor:pointer;margin-bottom:10px;font-family:'Instrument Sans',sans-serif">Create account</button>
      <div style="text-align:center">
        <button onclick="showAuthChoose()" style="background:none;border:none;font-size:12px;color:#64748b;cursor:pointer;font-family:'Instrument Sans',sans-serif;text-decoration:underline">Back</button>
      </div>
    </div>
    <div id="authViewSuccess" style="display:none;text-align:center;padding:20px 0">
      <div style="font-size:48px;margin-bottom:12px">üéâ</div>
      <div style="font-family:'Fraunces',serif;font-size:24px;font-weight:900;color:white;margin-bottom:8px">You're in!</div>
      <div style="font-size:14px;color:#94a3b8;margin-bottom:24px" id="authSuccessMsg">Your study plan has been saved.</div>
      <button onclick="closeModal()" style="padding:13px 32px;background:var(--green);color:white;border:none;border-radius:100px;font-size:14px;font-weight:700;cursor:pointer;font-family:'Instrument Sans',sans-serif">View my plan</button>
    </div>
  </div>
</div>
<style>@keyframes slideUp{from{transform:translateY(100%);opacity:0}to{transform:translateY(0);opacity:1}}}

/* ‚îÄ‚îÄ FEATURES SECTION ‚îÄ‚îÄ */
.fs-wrap{max-width:960px;margin:0 auto;padding:64px 24px 72px;}
.fs-badge{display:inline-flex;align-items:center;gap:6px;font-size:11px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:#6b7280;border:1px solid #e8e8e5;padding:4px 16px;border-radius:100px;margin-bottom:18px;}
.fs-h2{font-family:'Fraunces',serif;font-size:clamp(36px,6vw,54px);font-weight:900;letter-spacing:-2.5px;line-height:.92;margin-bottom:14px;}
.fs-h2 em{font-style:italic;color:#00a86b;}
.fs-sub{font-size:15px;color:#6b7280;max-width:420px;margin:0 auto;}
.fs-tabs{display:inline-flex;gap:4px;background:#f6f6f4;padding:4px;border-radius:14px;flex-wrap:wrap;justify-content:center;}
.fs-tab{padding:8px 18px;border-radius:10px;border:none;background:transparent;font-family:'Instrument Sans',sans-serif;font-size:13px;font-weight:600;color:#6b7280;cursor:pointer;transition:all .18s;white-space:nowrap;}
.fs-tab:hover{color:#0d0d0d;}
.fs-tab.on{background:#fff;color:#0d0d0d;box-shadow:0 1px 6px rgba(0,0,0,.09);}
.fs-panel{display:none;animation:fsIn .22s ease;}
.fs-panel.on{display:block;}
@keyframes fsIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
.fs-panel-badge{display:inline-flex;align-items:center;gap:6px;font-size:11px;font-weight:700;padding:4px 14px;border-radius:100px;margin-bottom:10px;}
.fs-panel-badge.bio{background:#e6f6ef;color:#007a4d;}
.fs-panel-badge.alg{background:#eff6ff;color:#1d4ed8;}
.fs-panel-badge.ela{background:#fdf4ff;color:#7e22ce;}
.fs-panel-badge.ush{background:#fff7ed;color:#c2410c;}
.fs-panel-badge.sat{background:#f0fdf4;color:#15803d;}
.fs-panel-h3{font-family:'Fraunces',serif;font-size:clamp(26px,4vw,40px);font-weight:900;letter-spacing:-1.5px;line-height:.95;margin-bottom:24px;}
.fs-panel-h3 em{font-style:italic;color:#00a86b;}
.fs-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:0;}
.fc{border:1.5px solid #e8e8e5;border-radius:16px;padding:22px;background:#fff;transition:border-color .18s,transform .18s,box-shadow .18s;}
.fc:hover{border-color:#0d0d0d;transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.07);}
.fc.wide{grid-column:span 2;background:#f6f6f4;border-color:#f6f6f4;}
.fc.wide:hover{border-color:#0d0d0d;}
.fc.dark{background:#0d0d0d;border-color:#0d0d0d;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;}
.fc.dark:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.18);}
.fc-ico{font-size:22px;margin-bottom:10px;}
.fc-lbl{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#9ca3af;margin-bottom:5px;}
.fc.dark .fc-lbl{color:rgba(255,255,255,.4);}
.fc-title{font-family:'Fraunces',serif;font-size:16px;font-weight:900;letter-spacing:-.4px;margin-bottom:8px;line-height:1.2;color:#0d0d0d;}
.fc.dark .fc-title{color:#fff;}
.fc-desc{font-size:12px;color:#6b7280;line-height:1.65;}
.fc-tag{display:inline-block;margin-top:10px;font-size:10px;font-weight:700;padding:3px 10px;background:#fff;border-radius:100px;color:#007a4d;border:1px solid #e6f6ef;}
.fc-link{display:inline-block;margin-top:10px;font-size:12px;font-weight:700;color:#007a4d;text-decoration:none;}
.fc-link:hover{text-decoration:underline;}
.fc-bignum{font-family:'Fraunces',serif;font-size:56px;font-weight:900;letter-spacing:-3px;line-height:1;color:#fff;}
.fc-biglbl{font-size:13px;font-weight:700;color:rgba(255,255,255,.7);margin:4px 0 8px;}
.fc-bigsub{font-size:11px;color:rgba(255,255,255,.4);line-height:1.55;}
.fs-cta-box{text-align:center;margin-top:48px;padding:40px 32px;background:#f6f6f4;border-radius:20px;}
.fs-cta-box p{font-family:'Fraunces',serif;font-size:22px;font-weight:900;letter-spacing:-.5px;margin-bottom:16px;}
.fs-cta-box a{display:inline-block;padding:13px 32px;background:#0d0d0d;color:#fff;border-radius:100px;font-size:14px;font-weight:700;text-decoration:none;font-family:'Instrument Sans',sans-serif;transition:background .15s;}
.fs-cta-box a:hover{background:#222;}
@media(max-width:680px){.fs-grid{grid-template-columns:1fr;}.fc.wide{grid-column:span 1;}.fs-tab{padding:7px 12px;font-size:12px;}.fs-wrap{padding:48px 16px 56px;}}

/* ‚îÄ‚îÄ UNIVERSAL NAV ‚îÄ‚îÄ */
nav{position:sticky;top:0;z-index:500;background:#fff;border-bottom:1px solid #e8e8e5;display:flex;align-items:center;justify-content:space-between;padding:0 24px;height:56px;}
.logo{display:flex;align-items:center;gap:9px;text-decoration:none;}
.logo-ico{width:28px;height:28px;background:linear-gradient(135deg,#0ea87a,#076b4f);border-radius:7px;display:flex;align-items:center;justify-content:center;flex-shrink:0;}
.logo-word{font-family:'Fraunces',serif;font-size:18px;font-weight:900;letter-spacing:-.5px;color:#0d0d0d;}
.logo-word em{color:#00a86b;font-style:normal;}
.nav-right{display:flex;align-items:center;gap:6px;}
.nav-link{font-size:13px;font-weight:600;color:#6b7280;text-decoration:none;padding:6px 10px;border-radius:8px;transition:color .15s;}
.nav-link:hover,.nav-link.active{color:#0d0d0d;}
.nav-search-wrap{position:relative;display:flex;align-items:center;}
.nav-search-btn{width:34px;height:34px;border:1.5px solid #e8e8e5;border-radius:100px;background:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .15s;}
.nav-search-btn:hover{border-color:#0d0d0d;}
.nav-search-input{position:absolute;right:36px;top:50%;transform:translateY(-50%);width:0;opacity:0;border:1.5px solid #e8e8e5;border-radius:100px;padding:0;background:#fff;font-family:'Instrument Sans',sans-serif;font-size:13px;transition:all .25s;pointer-events:none;}
.nav-search-input.open{width:200px;opacity:1;padding:6px 14px;pointer-events:all;}
.btn-support-nav{display:inline-flex;align-items:center;gap:5px;font-size:12px;font-weight:700;color:#0d0d0d;background:#FFDD00;border-radius:100px;padding:6px 14px;text-decoration:none;transition:all .15s;}
.btn-support-nav:hover{background:#f5d000;}
.nav-signin{font-size:13px;font-weight:700;color:#fff;background:#0d0d0d;padding:7px 16px;border-radius:100px;text-decoration:none;transition:background .15s;white-space:nowrap;}
.nav-signin:hover{background:#222;}
.nav-signin.loggedin{background:#00a86b;}
@media(max-width:640px){.nav-link{display:none;}.nav-search-input.open{width:140px;}}
</style>

<div class="flow-screen" id="s4">
  <div class="flow-section" style="padding-top:32px;padding-bottom:60px">
    <button class="btn-back-flow" onclick="goTo('s1');resetFlow()">‚Üê Start over</button>

    <!-- Regents results -->
    <div id="regentsResults">
      <div class="result-hero">
        <div class="result-emoji" id="rEmoji"></div>
        <div class="result-title" id="rTitle"></div>
        <div class="result-sub" id="rSub"></div>
      </div>
      <div id="rCards" style="margin-bottom:14px"></div>
      <div class="panel" id="studyPanel">
        <div class="panel-title">üìñ Study these tonight</div>
        <div id="studyItems"></div>
      </div>
    </div>

    <!-- Resume preview (shown when tutoring goal selected) -->
    <div id="resumeSection" style="display:none;margin-bottom:14px">
      <div style="background:white;border-radius:20px;border:1.5px solid var(--border);overflow:hidden">
        <div style="padding:20px 20px 0;display:flex;align-items:center;justify-content:space-between">
          <div>
            <div style="font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--teal);margin-bottom:3px">üìÑ Resume Builder</div>
            <div style="font-size:17px;font-weight:800;letter-spacing:-0.3px">Build your resume ‚Äî free</div>
          </div>
        </div>
        <div style="padding:16px 20px">
          <div style="font-size:13px;color:var(--gray);margin-bottom:16px">No experience needed. Enter your info below for a quick preview, then build the full version.</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:12px">
            <div><label style="font-size:11px;font-weight:700;color:var(--gray);display:block;margin-bottom:4px">Your name</label>
              <input id="rqName" type="text" placeholder="Maya Johnson" style="width:100%;padding:9px 12px;border:1.5px solid var(--border);border-radius:9px;font-size:13px;font-family:'Instrument Sans',sans-serif;outline:none" oninput="updateMiniResume()"></div>
            <div><label style="font-size:11px;font-weight:700;color:var(--gray);display:block;margin-bottom:4px">Grade</label>
              <select id="rqGrade" style="width:100%;padding:9px 12px;border:1.5px solid var(--border);border-radius:9px;font-size:13px;font-family:'Instrument Sans',sans-serif;outline:none;background:white" onchange="updateMiniResume()">
                <option value="">Select...</option>
                <option>9th Grade</option><option>10th Grade</option><option>11th Grade</option><option>12th Grade</option>
              </select></div>
          </div>
          <div style="margin-bottom:12px"><label style="font-size:11px;font-weight:700;color:var(--gray);display:block;margin-bottom:4px">Top skill or activity</label>
            <input id="rqSkill" type="text" placeholder="e.g. Python, Soccer team captain, Volunteer tutor" style="width:100%;padding:9px 12px;border:1.5px solid var(--border);border-radius:9px;font-size:13px;font-family:'Instrument Sans',sans-serif;outline:none" oninput="updateMiniResume()"></div>
          <!-- Mini resume preview -->
          <div id="miniResumePreview" style="background:#f8fafc;border:1.5px solid var(--border);border-radius:12px;padding:16px;margin-bottom:14px;display:none">
            <div style="font-family:'DM Serif Display',serif;font-size:18px;font-weight:400;margin-bottom:4px" id="mrName">Your Name</div>
            <div style="font-size:12px;color:var(--teal);font-weight:600;margin-bottom:8px" id="mrGrade"></div>
            <div style="font-size:11px;font-weight:700;color:var(--gray);text-transform:uppercase;letter-spacing:1px;margin-bottom:4px">Top Skill</div>
            <div style="font-size:13px;font-weight:600" id="mrSkill" style="color:var(--black)"></div>
          </div>
          <a onclick="window.open('resume.html','_blank')" href="#" style="display:block;text-align:center;background:var(--black);color:white;padding:12px;border-radius:11px;font-size:14px;font-weight:800;text-decoration:none;transition:all 0.2s">Build full resume ‚Üí</a>
        </div>
      </div>
    </div>

    <!-- Resource browser (always shown) -->
    <div class="res-browser">
      <div class="res-browser-head">
        <div>
          <div class="res-browser-label">üìö Resources for you</div>
          <div class="res-browser-title">Find your next opportunity</div>
        </div>
        <a onclick="window.open('resources.html','_blank')" href="#" class="res-see-all">See all ‚Üí</a>
      </div>
      <div class="res-pills" id="resPills">
        <button class="res-pill active" onclick="filterRes('all',this)">All</button>
        <button class="res-pill" onclick="filterRes('internship',this)">‚òÄÔ∏è Internships</button>
        <button class="res-pill" onclick="filterRes('scholarship',this)">üèÜ Scholarships</button>
        <button class="res-pill" onclick="filterRes('sat',this)">üìù SAT/ACT</button>
        <button class="res-pill" onclick="filterRes('college',this)">üéì College</button>
        <button class="res-pill" onclick="filterRes('study',this)">üìö Self-Study</button>
        <button class="res-pill" onclick="filterRes('graduate',this)">üèÖ Graduation</button>
      </div>
      <div class="res-grid" id="resGrid"></div>
      <a onclick="window.open('resources.html','_blank')" href="#" class="res-full-btn">Browse all 26+ resources on ZenEd ‚Üí</a>
    </div>

  </div>
</div>

<!-- ‚ïê‚ïê SAT SCREEN 1: Have you taken it? ‚ïê‚ïê -->
<div class="flow-screen" id="sat1">
  <div class="flow-section" style="padding-top:32px">
    <button class="btn-back-flow" onclick="goTo('s1')">‚Üê Back</button>
    <div class="progress-wrap"><div class="progress-bar"><div class="progress-fill" style="width:25%"></div></div><div class="progress-label">SAT Prep ¬∑ Step 1 of 3</div></div>
    <div class="step-label">Have you taken the SAT or PSAT?</div>
    <div class="subj-grid" style="grid-template-columns:1fr 1fr;max-width:480px;margin:0 auto 24px">
      <button class="subj-card" style="text-align:center" onclick="setSATStatus('never',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">üÜï</div><div class="subj-name">Never taken it</div><div style="font-size:11px;color:var(--gray);margin-top:4px">First time preparing</div></button>
      <button class="subj-card" style="text-align:center" onclick="setSATStatus('psat',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">üìä</div><div class="subj-name">Took the PSAT</div><div style="font-size:11px;color:var(--gray);margin-top:4px">Have a score to work from</div></button>
      <button class="subj-card" style="text-align:center" onclick="setSATStatus('sat',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">üìù</div><div class="subj-name">Took the SAT</div><div style="font-size:11px;color:var(--gray);margin-top:4px">Want to improve my score</div></button>
      <button class="subj-card" style="text-align:center" onclick="setSATStatus('act',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">üìã</div><div class="subj-name">Preparing for ACT</div><div style="font-size:11px;color:var(--gray);margin-top:4px">ACT instead of SAT</div></button>
    </div>
    <div style="text-align:center"><button class="btn-next" id="sat1Next" onclick="goTo('sat2')" disabled>Next ‚Üí</button></div>
  </div>
</div>

<!-- ‚ïê‚ïê SAT: STEP 2 ‚ïê‚ïê -->
<div class="flow-screen" id="sat2">
  <div class="flow-section" style="padding-top:32px">
    <button class="btn-back-flow" onclick="goTo('sat1')">‚Üê Back</button>
    <div class="progress-wrap"><div class="progress-bar"><div class="progress-fill" style="width:50%"></div></div><div class="progress-label">SAT Prep ¬∑ Step 2 of 3</div></div>
    <div id="sat2Content"></div>
    <div style="text-align:center"><button class="btn-next" onclick="goTo('sat3')">Next ‚Üí</button></div>
  </div>
</div>

<!-- ‚ïê‚ïê SAT: STEP 3 ‚ïê‚ïê -->
<div class="flow-screen" id="sat3">
  <div class="flow-section" style="padding-top:32px">
    <button class="btn-back-flow" onclick="goTo('sat2')">‚Üê Back</button>
    <div class="progress-wrap"><div class="progress-bar"><div class="progress-fill" style="width:75%"></div></div><div class="progress-label">SAT Prep ¬∑ Step 3 of 3</div></div>
    <div class="step-label">Which section feels hardest?</div>
    <p style="font-size:13px;color:var(--gray);text-align:center;margin-bottom:20px">We'll focus your plan here first ‚Äî biggest gains come from your weakest section.</p>
    <div class="subj-grid" style="grid-template-columns:1fr 1fr;max-width:480px;margin:0 auto 24px">
      <button class="subj-card" onclick="toggleSATSection('math',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">üìê</div><div class="subj-name">Math</div><div style="font-size:11px;color:var(--gray);margin-top:4px">Algebra, advanced math, geometry</div></button>
      <button class="subj-card" onclick="toggleSATSection('reading',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">üìñ</div><div class="subj-name">Reading & Writing</div><div style="font-size:11px;color:var(--gray);margin-top:4px">Comprehension, grammar, editing</div></button>
      <button class="subj-card" onclick="toggleSATSection('both',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">‚öñÔ∏è</div><div class="subj-name">Both equally weak</div><div style="font-size:11px;color:var(--gray);margin-top:4px">Start with a full practice test</div></button>
      <button class="subj-card" onclick="toggleSATSection('time',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">‚è±Ô∏è</div><div class="subj-name">Timing / test anxiety</div><div style="font-size:11px;color:var(--gray);margin-top:4px">Run out of time, get nervous</div></button>
    </div>
    <div style="text-align:center"><button class="btn-next" id="sat3Next" onclick="buildSATResults()" disabled>See my plan ‚Üí</button></div>
  </div>
</div>

<!-- ‚ïê‚ïê CTE: STEP 1 ‚ïê‚ïê -->
<div class="flow-screen" id="cte1">
  <div class="flow-section" style="padding-top:32px">
    <button class="btn-back-flow" onclick="goTo('s1')">‚Üê Back</button>
    <div class="progress-wrap"><div class="progress-bar"><div class="progress-fill" style="width:33%"></div></div><div class="progress-label">CTE Pathways ¬∑ Step 1 of 2</div></div>
    <div class="step-label">What industry interests you?</div>
    <p style="font-size:13px;color:var(--gray);text-align:center;margin-bottom:20px">CTE programs let you graduate with real skills and certifications ‚Äî no 4-year degree required.</p>
    <div class="subj-grid" style="grid-template-columns:1fr 1fr;max-width:520px;margin:0 auto 24px">
      <button class="subj-card" onclick="toggleCTE('tech',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">üíª</div><div class="subj-name">Technology & Coding</div><div style="font-size:11px;color:var(--gray);margin-top:4px">Avg salary: $65K‚Äì$110K</div></button>
      <button class="subj-card" onclick="toggleCTE('health',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">üè•</div><div class="subj-name">Healthcare & Medicine</div><div style="font-size:11px;color:var(--gray);margin-top:4px">Avg salary: $50K‚Äì$100K</div></button>
      <button class="subj-card" onclick="toggleCTE('business',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">üíº</div><div class="subj-name">Business & Finance</div><div style="font-size:11px;color:var(--gray);margin-top:4px">Avg salary: $50K‚Äì$85K</div></button>
      <button class="subj-card" onclick="toggleCTE('law',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">‚öñÔ∏è</div><div class="subj-name">Law & Criminal Justice</div><div style="font-size:11px;color:var(--gray);margin-top:4px">Avg salary: $48K‚Äì$90K</div></button>
    </div>
    <div style="text-align:center"><button class="btn-next" id="cte1Next" onclick="goTo('cte2')" disabled>Next ‚Üí</button></div>
  </div>
</div>

<!-- ‚ïê‚ïê CTE: STEP 2 ‚ïê‚ïê -->
<div class="flow-screen" id="cte2">
  <div class="flow-section" style="padding-top:32px">
    <button class="btn-back-flow" onclick="goTo('cte1')">‚Üê Back</button>
    <div class="progress-wrap"><div class="progress-bar"><div class="progress-fill" style="width:66%"></div></div><div class="progress-label">CTE Pathways ¬∑ Step 2 of 2</div></div>
    <div class="step-label">What do you want after graduation?</div>
    <div style="max-width:480px;margin:0 auto 24px;display:flex;flex-direction:column;gap:10px">
      <button class="subj-card" style="text-align:left;display:flex;align-items:center;gap:14px" onclick="setCTEGoal('job',this)"><div class="subj-card-check">‚úì</div><span style="font-size:28px;flex-shrink:0">üí∞</span><div><div class="subj-name">A job right away</div><div style="font-size:11px;color:var(--gray);margin-top:3px">Start earning after HS ‚Äî certifications get you hired fast</div></div></button>
      <button class="subj-card" style="text-align:left;display:flex;align-items:center;gap:14px" onclick="setCTEGoal('associate',this)"><div class="subj-card-check">‚úì</div><span style="font-size:28px;flex-shrink:0">üèõÔ∏è</span><div><div class="subj-name">Associate degree (2 years)</div><div style="font-size:11px;color:var(--gray);margin-top:3px">CUNY or P-TECH ‚Äî free or affordable, done in 2 years</div></div></button>
      <button class="subj-card" style="text-align:left;display:flex;align-items:center;gap:14px" onclick="setCTEGoal('both',this)"><div class="subj-card-check">‚úì</div><span style="font-size:28px;flex-shrink:0">üöÄ</span><div><div class="subj-name">Keep all options open</div><div style="font-size:11px;color:var(--gray);margin-top:3px">Get certified AND keep a path to 4-year degree if you want later</div></div></button>
    </div>
    <div style="text-align:center"><button class="btn-next" id="cte2Next" onclick="buildCTEResults()" disabled>See my pathways ‚Üí</button></div>
  </div>
</div>

<!-- ‚ïê‚ïê COLLEGE: STEP 1 ‚ïê‚ïê -->
<div class="flow-screen" id="col1">
  <div class="flow-section" style="padding-top:32px">
    <button class="btn-back-flow" onclick="goTo('s1')">‚Üê Back</button>
    <div class="progress-wrap"><div class="progress-bar"><div class="progress-fill" style="width:50%"></div></div><div class="progress-label">College Admissions ¬∑ Step 1 of 1</div></div>
    <div class="step-label">What grade are you in?</div>
    <p style="font-size:13px;color:var(--gray);text-align:center;margin-bottom:20px">Your roadmap is different depending on where you are. We'll build the right one.</p>
    <div class="subj-grid" style="grid-template-columns:repeat(4,1fr);max-width:480px;margin:0 auto 24px">
      <button class="subj-card" style="text-align:center" onclick="setColGrade('9',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">9Ô∏è‚É£</div><div class="subj-name">9th</div></button>
      <button class="subj-card" style="text-align:center" onclick="setColGrade('10',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">üîü</div><div class="subj-name">10th</div></button>
      <button class="subj-card" style="text-align:center" onclick="setColGrade('11',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">1Ô∏è‚É£</div><div class="subj-name">11th</div></button>
      <button class="subj-card" style="text-align:center" onclick="setColGrade('12',this)"><div class="subj-card-check">‚úì</div><div class="subj-icon">üéì</div><div class="subj-name">12th</div></button>
    </div>
    <div style="text-align:center"><button class="btn-next" id="col1Next" onclick="buildCollegeResults()" disabled>See my roadmap ‚Üí</button></div>
  </div>
</div>

<!-- ‚ïê‚ïê FEATURES SECTION ‚ïê‚ïê -->
<div id="featuresSection">
<hr style="border:none;border-top:1px solid #e8e8e5;max-width:960px;margin:0 auto;">
<div class="fs-wrap">

  <div style="text-align:center;margin-bottom:40px;">
    <div class="fs-badge">‚ú¶ What ZenEd gives you</div>
    <h2 class="fs-h2">All the tools you need<br><em>in one spot.</em></h2>
    <p class="fs-sub">Built for students. Every Regents subject. Free forever.</p>
  </div>

  <div style="display:flex;justify-content:center;margin-bottom:36px;">
    <div class="fs-tabs">
      <button class="fs-tab on" onclick="fsTab('bio',this)">üß¨ Living Env</button>
      <button class="fs-tab" onclick="fsTab('alg',this)">üìê Algebra I</button>
      <button class="fs-tab" onclick="fsTab('ela',this)">üìñ ELA</button>
      <button class="fs-tab" onclick="fsTab('ush',this)">üóΩ US History</button>
      <button class="fs-tab" onclick="fsTab('sat',this)">üéØ SAT Prep</button>
      <button class="fs-tab" onclick="fsTab('cte',this)">üè´ CTE</button>
    </div>
  </div>

  <!-- BIO -->
  <div id="fsp-bio" class="fs-panel on">
    <div class="fs-panel-badge bio">üß¨ Living Environment</div>
    <h3 class="fs-panel-h3">Pass the Living Environment<br><em>Regents with confidence.</em></h3>
    <div class="fs-grid">
      <div class="fc wide">
        <div class="fc-ico">üìä</div>
        <div class="fc-lbl">Readiness Score</div>
        <div class="fc-title">Know exactly where you stand</div>
        <div class="fc-desc">Enter your unit grades and get an instant color-coded readiness score ‚Äî red, yellow, or green. No guessing about whether you'll pass. No login needed.</div>
        <button onclick="window.scrollTo({top:0,behavior:'smooth'});setTimeout(()=>{document.getElementById('gc-regents')?.click();setTimeout(()=>document.getElementById('startBtn')?.click(),250)},400)" class="fc-link" style="background:none;border:none;padding:0;cursor:pointer;font-family:inherit;text-align:left;">‚Üí Get my Regents plan</button>
      </div>
      <div class="fc dark">
        <div class="fc-bignum">6</div>
        <div class="fc-biglbl">Units covered</div>
        <div class="fc-bigsub">Cell Biology ¬∑ Genetics ¬∑ Ecology ¬∑ Evolution ¬∑ Homeostasis ¬∑ Human Impact</div>
      </div>
      <div class="fc">
        <div class="fc-ico">üìù</div>
        <div class="fc-lbl">Past Exams</div>
        <div class="fc-title">Official NYSED exams ‚Äî every year</div>
        <div class="fc-desc">Every past Living Environment Regents PDF from NYSED. Exam + answer key + rating guide. January, June, August sessions.</div>
        <a href="practice.html" class="fc-link">Go to Practice ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üéØ</div>
        <div class="fc-lbl">Warm-Up Quiz</div>
        <div class="fc-title">10 questions, instant feedback</div>
        <div class="fc-desc">Regents-style questions with detailed explanations for every answer. Covers all 6 units ‚Äî cell biology, genetics, ecology, evolution, homeostasis, human impact.</div>
        <a href="practice.html" class="fc-link">Try a quiz ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üìö</div>
        <div class="fc-lbl">Unit Study Plan</div>
        <div class="fc-title">Weakest units first, always</div>
        <div class="fc-desc">Direct links to New Visions biology curriculum (all 6 units) and RegentsPrep ‚Äî personalized to your worst-scoring units, not a generic list.</div>
        <button onclick="window.scrollTo({top:0,behavior:'smooth'});setTimeout(()=>{document.getElementById('gc-regents')?.click();setTimeout(()=>document.getElementById('startBtn')?.click(),250)},400)" class="fc-link" style="background:none;border:none;padding:0;cursor:pointer;font-family:inherit;text-align:left;">‚Üí Get my study plan</button>
      </div>
      <div class="fc">
        <div class="fc-ico">üî¨</div>
        <div class="fc-lbl">Real Lab Resources</div>
        <div class="fc-title">Harvard LabXchange + New Visions</div>
        <div class="fc-desc">LabXchange Life Sciences collection (grades 9-12) for virtual labs. Full New Visions Biology curriculum ‚Äî all 6 units, free. Perfect for Living Environment Regents.</div>
        <a href="https://www.labxchange.org/c/ngss?subject=life-sciences&grade=grades-9-12" target="_blank" class="fc-link">LabXchange Life Sciences ‚Üí</a>
      </div>
    </div>
  </div>

  <!-- ALGEBRA -->
  <div id="fsp-alg" class="fs-panel">
    <div class="fs-panel-badge alg">üìê Algebra I</div>
    <h3 class="fs-panel-h3">Master Algebra I ‚Äî<br><em>one unit at a time.</em></h3>
    <div class="fs-grid">
      <div class="fc wide">
        <div class="fc-ico">üìä</div>
        <div class="fc-lbl">Grade Calculator</div>
        <div class="fc-title">NY‚ÜíM+ scale with real weighted scoring</div>
        <div class="fc-desc">Enter letter grades (NY, NY+, L, L+, D, D+, P, P+, M, M+) or numbers. Formative 50% ¬∑ Summative 30% ¬∑ Engagement 20%. Works with New Visions grading ‚Äî see your real readiness score in seconds.</div>
        <button onclick="window.scrollTo({top:0,behavior:'smooth'});setTimeout(()=>{document.getElementById('gc-regents')?.click();setTimeout(()=>document.getElementById('startBtn')?.click(),250)},400)" class="fc-link" style="background:none;border:none;padding:0;cursor:pointer;font-family:inherit;text-align:left;">‚Üí Get my Algebra plan</button>
      </div>
      <div class="fc dark">
        <div class="fc-bignum">3</div>
        <div class="fc-biglbl">Units covered</div>
        <div class="fc-bigsub">Linear Functions ¬∑ Quadratic Functions ¬∑ Statistics & Probability</div>
      </div>
      <div class="fc">
        <div class="fc-ico">üìù</div>
        <div class="fc-lbl">Past Exams</div>
        <div class="fc-title">All Algebra I Regents PDFs</div>
        <div class="fc-desc">June, January, August sessions from NYSED ‚Äî every exam with answer keys, scoring guides, and conversion charts.</div>
        <a href="practice.html" class="fc-link">Go to Practice ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üéØ</div>
        <div class="fc-lbl">Practice Quiz</div>
        <div class="fc-title">10 Regents-style algebra questions</div>
        <div class="fc-desc">Linear equations, factoring, functions, word problems, inequalities ‚Äî with step-by-step explanations for every answer. No account needed.</div>
        <a href="practice.html" class="fc-link">Try a quiz ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üßÆ</div>
        <div class="fc-lbl">Desmos Calculator</div>
        <div class="fc-title">Same graphing calculator as the exam</div>
        <div class="fc-desc">Practice with the exact Desmos calculator you'll use on the real Regents. Plus Khan Academy Algebra I ‚Äî free, personalized to your weakest skills.</div>
        <a href="https://www.desmos.com/calculator" target="_blank" class="fc-link">Open Desmos ‚Üí</a>
      </div>
    </div>
  </div>

  <!-- ELA -->
  <div id="fsp-ela" class="fs-panel">
    <div class="fs-panel-badge ela">üìñ ELA</div>
    <h3 class="fs-panel-h3">Write. Argue. Analyze.<br><em>Pass the ELA Regents.</em></h3>
    <div class="fs-grid">
      <div class="fc wide">
        <div class="fc-ico">‚úçÔ∏è</div>
        <div class="fc-lbl">Writing Focus</div>
        <div class="fc-title">All 3 ELA tasks ‚Äî Reading, Argument, Analysis</div>
        <div class="fc-desc">Reading Comprehension, Argument Essay, and Text Analysis Response. Your plan shows exactly what each task requires and how to score full credit on every rubric item ‚Äî including how to cite evidence correctly.</div>
        <button onclick="window.scrollTo({top:0,behavior:'smooth'});setTimeout(()=>{document.getElementById('gc-regents')?.click();setTimeout(()=>document.getElementById('startBtn')?.click(),250)},400)" class="fc-link" style="background:none;border:none;padding:0;cursor:pointer;font-family:inherit;text-align:left;">‚Üí Get my ELA plan</button>
      </div>
      <div class="fc dark">
        <div class="fc-bignum">3</div>
        <div class="fc-biglbl">Tasks covered</div>
        <div class="fc-bigsub">Reading Comprehension ¬∑ Argument Essay ¬∑ Text Analysis Response</div>
      </div>
      <div class="fc">
        <div class="fc-ico">üìù</div>
        <div class="fc-lbl">Past Exams</div>
        <div class="fc-title">All HS ELA Regents PDFs</div>
        <div class="fc-desc">Official NYSED High School ELA ‚Äî every session with scoring guides, anchor papers showing full-credit responses, and rating guides.</div>
        <a href="practice.html" class="fc-link">Go to Practice ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üéØ</div>
        <div class="fc-lbl">Practice Quiz</div>
        <div class="fc-title">10 Regents-style ELA questions</div>
        <div class="fc-desc">Evidence types, grammar, literary devices, claims, transitions, point of view ‚Äî with full explanations for every answer.</div>
        <a href="practice.html" class="fc-link">Try a quiz ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üèÜ</div>
        <div class="fc-lbl">The #1 ELA Mistake</div>
        <div class="fc-title">Analyze, don't summarize</div>
        <div class="fc-desc">Most students summarize the text instead of analyzing it ‚Äî and lose 2‚Äì4 points on every written response. Your plan shows exactly what "analysis" looks like with anchor examples.</div>
        <button onclick="window.scrollTo({top:0,behavior:'smooth'});setTimeout(()=>{document.getElementById('gc-regents')?.click();setTimeout(()=>document.getElementById('startBtn')?.click(),250)},400)" class="fc-link" style="background:none;border:none;padding:0;cursor:pointer;font-family:inherit;text-align:left;">‚Üí Get my ELA plan</button>
      </div>
    </div>
  </div>

  <!-- US HISTORY -->
  <div id="fsp-ush" class="fs-panel">
    <div class="fs-panel-badge ush">üóΩ US History</div>
    <h3 class="fs-panel-h3">Documents, essays, civic literacy ‚Äî<br><em>all handled.</em></h3>
    <div class="fs-grid">
      <div class="fc wide">
        <div class="fc-ico">üìú</div>
        <div class="fc-lbl">Document-Based Focus</div>
        <div class="fc-title">The Civic Literacy Essay ‚Äî cracked</div>
        <div class="fc-desc">The hardest part of US History & Government Regents is the Civic Literacy Essay with primary sources. Your plan targets your weakest historical eras with direct links to primary sources and NYSED rating guides.</div>
        <button onclick="window.scrollTo({top:0,behavior:'smooth'});setTimeout(()=>{document.getElementById('gc-regents')?.click();setTimeout(()=>document.getElementById('startBtn')?.click(),250)},400)" class="fc-link" style="background:none;border:none;padding:0;cursor:pointer;font-family:inherit;text-align:left;">‚Üí Get my US History plan</button>
      </div>
      <div class="fc dark">
        <div class="fc-bignum">3</div>
        <div class="fc-biglbl">Eras covered</div>
        <div class="fc-bigsub">Colonial ‚Üí Industrial ‚Üí Modern America</div>
      </div>
      <div class="fc">
        <div class="fc-ico">üìù</div>
        <div class="fc-lbl">Past Exams</div>
        <div class="fc-title">Jan 2026 ¬∑ Aug 2025 ¬∑ June 2025</div>
        <div class="fc-desc">Every US History & Government Regents from NYSED ‚Äî exam PDF, scoring key, rating guide, and conversion chart. With translated versions in 10+ languages.</div>
        <a href="practice.html" class="fc-link">Go to Practice ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üéØ</div>
        <div class="fc-lbl">Practice Quiz</div>
        <div class="fc-title">10 Regents-style history questions</div>
        <div class="fc-desc">Checks & balances, Reconstruction, New Deal, Civil Rights, Cold War, Constitution ‚Äî with context-rich explanations every time.</div>
        <a href="practice.html" class="fc-link">Try a quiz ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üåê</div>
        <div class="fc-lbl">Translated Exams</div>
        <div class="fc-title">10+ languages available</div>
        <div class="fc-desc">NYSED provides US History Regents in Spanish, Chinese, Haitian Creole, Bengali, Arabic, Korean, Russian, and more. Same exam, your language.</div>
        <a href="https://www.nysedregents.org/translatedexams.html" target="_blank" class="fc-link">Get translated exams ‚Üí</a>
      </div>
    </div>
  </div>

  <!-- SAT PREP -->
  <div id="fsp-sat" class="fs-panel">
    <div class="fs-panel-badge sat">üéØ SAT Prep</div>
    <h3 class="fs-panel-h3">A real study schedule ‚Äî<br><em>not just a list of links.</em></h3>
    <div class="fs-grid">
      <div class="fc wide">
        <div class="fc-ico">üìÖ</div>
        <div class="fc-lbl">Personalized Study Schedule</div>
        <div class="fc-title">Day-by-day, built on your score and timeline</div>
        <div class="fc-desc">Enter your exam date, last score (or 0 if no prior test), and weakest section. Get a day-by-day plan with Bluebook practice tests, Khan Academy modules, and weak-section drills ‚Äî no guesswork.</div>
        <button onclick="window.scrollTo({top:0,behavior:'smooth'});setTimeout(()=>{document.getElementById('gc-sat')?.click();setTimeout(()=>document.getElementById('startBtn')?.click(),250)},400)" class="fc-link" style="background:none;border:none;padding:0;cursor:pointer;font-family:inherit;text-align:left;">‚Üí Build my SAT schedule</button>
      </div>
      <div class="fc dark">
        <div class="fc-bignum">+150</div>
        <div class="fc-biglbl">avg point gain</div>
        <div class="fc-bigsub">Students following a structured plan consistently outperform self-study</div>
      </div>
      <div class="fc">
        <div class="fc-ico">üíª</div>
        <div class="fc-lbl">Bluebook ‚Äî Official Digital SAT</div>
        <div class="fc-title">Full-length practice in exact exam format</div>
        <div class="fc-desc">College Board's Bluebook app ‚Äî same interface, same adaptive difficulty, same tools as the real digital SAT. Your plan schedules exactly when to take each test.</div>
        <a href="https://bluebook.collegeboard.org" target="_blank" class="fc-link">Get Bluebook (free) ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üí∞</div>
        <div class="fc-lbl">Fee Waivers</div>
        <div class="fc-title">Free SAT for income-eligible students</div>
        <div class="fc-desc">Many public school juniors qualify for a free SAT. Your plan includes exact steps to claim your fee waiver ‚Äî ask your school counselor in September of junior year.</div>
        <a href="https://www.schools.nyc.gov/learning/student-support/academic-support/standardized-test-prep" target="_blank" class="fc-link">NYC DOE SAT prep + fee waivers ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üéì</div>
        <div class="fc-lbl">Khan Academy ‚Äî Official Free Prep</div>
        <div class="fc-title">Personalized to your PSAT results</div>
        <div class="fc-desc">Link your PSAT scores and get a personalized Khan Academy Official SAT Practice plan. Students who practice 20 hrs improve ~115 points on average. Completely free.</div>
        <a href="https://www.khanacademy.org/sat" target="_blank" class="fc-link">Start Khan SAT prep ‚Üí</a>
      </div>
    </div>
  </div>

  <!-- CTE -->
  <div id="fsp-cte" class="fs-panel">
    <div class="fs-panel-badge" style="background:#fff7ed;color:#c2410c;">üè´ CTE Pathways</div>
    <h3 class="fs-panel-h3">Career skills, real credentials ‚Äî<br><em>starting in high school.</em></h3>
    <div class="fs-grid">
      <div class="fc wide">
        <div class="fc-ico">‚öôÔ∏è</div>
        <div class="fc-lbl">NYC CTE ‚Äî 400+ Career Pathways</div>
        <div class="fc-title">Industry certifications built into your high school</div>
        <div class="fc-desc">Free career and technical programs at NYC high schools. Technology, Healthcare, Architecture, Business, Culinary, Law, Engineering. CTE credentials now count toward the new Portrait of a Graduate graduation requirements.</div>
        <button onclick="window.scrollTo({top:0,behavior:'smooth'});setTimeout(()=>{document.getElementById('gc-cte')?.click();setTimeout(()=>document.getElementById('startBtn')?.click(),250)},400)" class="fc-link" style="background:none;border:none;padding:0;cursor:pointer;font-family:inherit;text-align:left;">‚Üí Explore my CTE options</button>
      </div>
      <div class="fc dark">
        <div class="fc-bignum">400+</div>
        <div class="fc-biglbl">CTE programs in NYC</div>
        <div class="fc-bigsub">Tech ¬∑ Health ¬∑ Business ¬∑ Law ¬∑ Arts ¬∑ Culinary ¬∑ Engineering</div>
      </div>
      <div class="fc">
        <div class="fc-ico">üè´</div>
        <div class="fc-lbl">NYC DOE CTE</div>
        <div class="fc-title">Browse all 400+ CTE programs</div>
        <div class="fc-desc">The official NYC DOE directory of every CTE program ‚Äî searchable by industry, school, and borough. Find what's available near you.</div>
        <a href="https://www.schools.nyc.gov/learning/programs/career-and-technical-education" target="_blank" class="fc-link">Explore NYC CTE programs ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üíª</div>
        <div class="fc-lbl">P-TECH</div>
        <div class="fc-title">Free associate degree + IBM mentorship</div>
        <div class="fc-desc">6-year combined high school + CUNY associate's degree program. No admissions test. IBM mentorship built in. Graduate with a diploma AND a college degree. Apply in 8th grade.</div>
        <a href="https://www.ptech.org" target="_blank" class="fc-link">ptech.org ‚Üí</a>
      </div>
      <div class="fc">
        <div class="fc-ico">üìã</div>
        <div class="fc-lbl">Growing Up NYC ‚Äî CTE Guide</div>
        <div class="fc-title">City-wide CTE guide for youth</div>
        <div class="fc-desc">Growing Up NYC's guide to CTE programs ‚Äî searchable by interest, industry, and grade level. Covers all 5 boroughs with application timelines.</div>
        <a href="https://www.schools.nyc.gov/learning/student-journey/career-connected-learning/career-and-technical-education-cte/" target="_blank" class="fc-link">Browse by interest ‚Üí</a>
      </div>
    </div>
  </div>

  <div class="fs-cta-box">
    <p>Ready to find out where you actually stand?</p>
    <a href="#" onclick="window.scrollTo({top:0,behavior:'smooth'});return false">Get my free plan ‚Äî it's free</a>
  </div>

</div>
</div>
<!-- ‚ïê‚ïê END FEATURES SECTION ‚ïê‚ïê -->

<!-- FOOTER -->
<footer>
  <a href="#" class="logo" onclick="resetFlow();return false;">
    <div class="logo-ico" style="width:26px;height:26px;border-radius:7px"><svg viewBox="0 0 24 24" fill="none" width="13" height="13"><path d="M12 3L4 8V16L12 21L20 16V8L12 3Z" stroke="white" stroke-width="1.5" stroke-linejoin="round"/><path d="M8 11L12 15L16 11" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 7V15" stroke="white" stroke-width="1.5" stroke-linecap="round"/></svg></div>
    <span class="logo-word" style="font-size:16px">Zen<em>Ed</em></span>
  </a>
  <div class="footer-links">
    <a href="mission.html">Mission</a>
    <a href="resources.html">Resources</a>
    <a href="terms.html">Terms</a>
    <a href="privacy.html">Privacy</a>
  </div>
  <div style="font-size:12px;color:#bbb">¬© 2026 ZenEd ¬∑ Always free</div>
<div style="text-align:center;margin:16px 0 4px;width:100%;">
  <a href="https://ko-fi.com/zened" target="_blank" style="display:inline-flex;align-items:center;gap:8px;background:#FFDD00;color:#000;font-size:13px;font-weight:800;padding:9px 20px;border-radius:20px;text-decoration:none;box-shadow:0 2px 10px rgba(0,0,0,0.1);transition:all 0.2s;">‚òï Support ZenEd ‚Äî keep it free for students</a>
  <div style="font-size:11px;color:#aaa;margin-top:6px;">Every dollar keeps ZenEd free for students who can't afford tutors.</div>
</div>
</footer>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// USAGE TRACKING (localStorage ‚Äî no server needed)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function track(event, data) {
  try {
    const log = JSON.parse(localStorage.getItem('zened_events') || '[]');
    log.push({ event, data, ts: new Date().toISOString() });
    localStorage.setItem('zened_events', JSON.stringify(log.slice(-200))); // keep last 200
  } catch(e) {}
}
// You can view analytics any time in the browser console:
// JSON.parse(localStorage.getItem('zened_events'))

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FLOW STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚îÄ‚îÄ NY‚ÜíM+ SCALE ‚îÄ‚îÄ
const NY_SCALE = [
  {label:'NY',  num:45,  color:'red',    pass:false},
  {label:'NY+', num:57,  color:'red',    pass:false},
  {label:'L',   num:61,  color:'yellow', pass:false},
  {label:'L+',  num:63,  color:'yellow', pass:false},
  {label:'D',   num:66,  color:'yellow', pass:true},
  {label:'D+',  num:68,  color:'yellow', pass:true},
  {label:'P',   num:72,  color:'green',  pass:true},
  {label:'P+',  num:77,  color:'green',  pass:true},
  {label:'M',   num:85,  color:'green',  pass:true},
  {label:'M+',  num:95,  color:'green',  pass:true},
];
function scaleFromNum(n){ return [...NY_SCALE].reverse().find(s=>n>=s.num)||NY_SCALE[0]; }
function toNum(val){
  const lbl=String(val).trim().toUpperCase();
  const found=NY_SCALE.find(s=>s.label===lbl);
  if(found)return found.num;
  const n=parseInt(val);
  return isNaN(n)?null:Math.max(0,Math.min(100,n));
}

// ‚îÄ‚îÄ SUBJECTS + UNITS ‚îÄ‚îÄ
const SUBJS = {
  biology:    {name:'Biology', icon:'üß¨', units:[
    {id:'u1',emoji:'üèÉ',name:'Unit 1: Marathon Runner',   topic:'Homeostasis & Cellular Respiration', tip:'Gas exchange and cellular respiration appear on every Regents.', link:'https://curriculum.newvisions.org/science/course/course-biology/', khan:'https://www.labxchange.org/library?t=Language%3Aen&t=SubjectArea%3ABiological+Sciences%3ACell+Biology&t=SubjectArea%3ABiological+Sciences%3AGenetics&page=1&size=24&order=relevance'},
    {id:'u2',emoji:'ü¶†',name:'Unit 2: Humans vs. Bacteria',topic:'Natural Selection & Antibiotic Resistance',tip:'Know the Rock Pocket Mice experiment ‚Äî it\'s on the Regents.', link:'https://curriculum.newvisions.org/science/course/course-biology/', khan:'https://www.learner.org/series/essential-science-for-teachers/life-science/'},
    {id:'u3',emoji:'üß¨',name:'Unit 3: Sick Humans',        topic:'DNA Structure & Protein Synthesis',  tip:'DNA‚ÜíRNA‚ÜíProtein is essential. Practice CER writing too.', link:'https://curriculum.newvisions.org/science/course/course-biology/', khan:'https://www.learner.org/series/essential-science-for-teachers/life-science/'},
    {id:'u4',emoji:'ü¶Å',name:'Unit 4: Mountain Lion',      topic:'Meiosis, Mitosis & Genetics',        tip:'Punnett squares appear every year. Know mitosis vs meiosis.', link:'https://curriculum.newvisions.org/science/course/course-biology/', khan:'https://www.learner.org/series/essential-science-for-teachers/life-science/'},
    {id:'u5',emoji:'üå±',name:'Unit 5: Food for All',        topic:'Photosynthesis & Ecosystems',        tip:'Photosynthesis and food webs are high-frequency Regents topics.', link:'https://curriculum.newvisions.org/science/course/course-biology/', khan:'https://www.labxchange.org/library?t=Language%3Aen&t=SubjectArea%3ABiological+Sciences%3ACell+Biology&t=SubjectArea%3ABiological+Sciences%3AGenetics&page=1&size=24&order=relevance'},
    {id:'u6',emoji:'ü¶£',name:'Unit 6: Woolly Mammoth',     topic:'Biodiversity & Human Impact',        tip:'Human impact on ecosystems is common in the last Regents section.', link:'https://curriculum.newvisions.org/science/course/course-biology/', khan:'https://www.learner.org/series/essential-science-for-teachers/life-science/'},
  ]},
  algebra:    {name:'Algebra 1', icon:'üìê', units:[
    {id:'a1',emoji:'üìê',name:'Linear Equations & Systems', topic:'Linear Equations, Inequalities, Word Problems', tip:'Systems of equations appear every year. Practice writing from word problems.', link:'https://www.regentsprep.org/algebra/', khan:'https://www.regentsprep.org/algebra/'},
    {id:'a2',emoji:'üìà',name:'Functions & Quadratics',      topic:'Functions, Quadratics, Factoring',    tip:'Know how to factor and use the quadratic formula.', link:'https://www.regentsprep.org/algebra/', khan:'https://www.regentsprep.org/algebra/'},
    {id:'a3',emoji:'üìä',name:'Statistics & Data',           topic:'Statistics, Scatter Plots, Probability', tip:'Statistics questions are worth a lot ‚Äî students often skip them.', link:'https://www.regentsprep.org/algebra2/', khan:'https://www.regentsprep.org/algebra/'},
  ]},
  ela:        {name:'English ELA', icon:'üìñ', units:[
    {id:'e1',emoji:'üìñ',name:'Reading & Text Analysis',   topic:'Reading Comprehension, Literary Analysis', tip:'Read questions BEFORE the passage ‚Äî saves time and focuses reading.', link:'https://www.regentsprep.org/ela/', khan:'https://www.regentsprep.org/ela'},
    {id:'e2',emoji:'‚úçÔ∏è',name:'Writing & Argumentation',  topic:'Argument Essay, Evidence & Reasoning', tip:'Your essay needs a clear claim, 3 pieces of evidence, and a counterargument.', link:'https://www.regentsprep.org/ela/', khan:'https://www.regentsprep.org/ela'},
    {id:'e3',emoji:'üî§',name:'Grammar & Editing',          topic:'Revising & Editing, Grammar',          tip:'Revising & Editing is the most coachable part of ELA. Practice eliminating redundancy.', link:'https://www.regentsprep.org/ela/', khan:'https://www.regentsprep.org/ela'},
  ]},
  us_history: {name:'US History', icon:'üá∫üá∏', units:[
    {id:'h1',emoji:'üèõÔ∏è',name:'Foundations to Civil War',  topic:'Constitution, Civil War, Reconstruction', tip:'Know the major turning points ‚Äî Constitution, Civil War causes.', link:'https://www.regentsprep.org/us-history/', khan:'https://www.regentsprep.org/us-history/'},
    {id:'h2',emoji:'üè≠',name:'Industrial Era to WWII',    topic:'Progressive Era, Great Depression, WWII', tip:'The Great Depression and New Deal appear on almost every Regents.', link:'https://www.regentsprep.org/us-history/', khan:'https://www.regentsprep.org/us-history/'},
    {id:'h3',emoji:'üåé',name:'Cold War to Modern',         topic:'Cold War, Civil Rights, DBQ Skills',   tip:'DBQ ‚Äî always tie your answer back to the document AND historical context.', link:'https://www.regentsprep.org/us-history/', khan:'https://www.regentsprep.org/us-history/'},
  ]},
  shsat:      {name:'SHSAT Prep', icon:'üè´', units:[
    {id:'s1',emoji:'üìù',name:'ELA & Scrambled Paragraphs', topic:'Scrambled Paragraphs, Reading, Editing', tip:'Scrambled Paragraphs are unique to SHSAT ‚Äî practice this daily.', link:'https://www.schools.nyc.gov/enrollment/high-school/specialized-high-schools/how-to-prepare', khan:'https://www.schools.nyc.gov/enrollment/high-school/specialized-high-schools/how-to-prepare'},
    {id:'s2',emoji:'üî¢',name:'Math',                       topic:'Algebra, Geometry, Word Problems',    tip:'SHSAT math is harder than Regents Algebra. Focus on multi-step word problems.', link:'https://www.schools.nyc.gov/enrollment/high-school/specialized-high-schools/how-to-prepare', khan:'https://www.schools.nyc.gov/enrollment/high-school/specialized-high-schools/how-to-prepare'},
  ]},
};

let goals = [], selSubjs = [], selUnits = [], unitScores = {}, unitIdx = 0;

function goTo(id) {
  document.querySelectorAll('.flow-screen').forEach(s => s.classList.remove('active'));
  const s1 = document.getElementById('s1');
  if (id === 's1') { s1.style.display = 'block'; }
  else { s1.style.display = 'none'; document.getElementById(id).classList.add('active'); }
  window.scrollTo({top:0, behavior:'smooth'});
}

function resetFlow() {
  goals = []; selSubjs = []; selUnits = []; unitScores = {}; unitIdx = 0;
  satStatus=null; satWeakSection=null; satScore=null; satTarget=null; satTimeframe=null;
  cteIndustry=null; cteGoal=null; colGrade=null;
  document.querySelectorAll('.goal-card,.subj-card').forEach(c => c.classList.remove('selected'));
  document.getElementById('startBtn').disabled = true;
  document.getElementById('s1').style.display = 'block';
  document.querySelectorAll('.flow-screen').forEach(s => s.classList.remove('active'));
}

// ‚îÄ‚îÄ GOAL SELECTION ‚îÄ‚îÄ
function toggleGoal(id, el) {
  el.classList.toggle('selected');
  if (goals.includes(id)) goals = goals.filter(g => g !== id);
  else goals.push(id);
  document.getElementById('startBtn').disabled = goals.length === 0;
  track('goal_toggle', {goal:id, allGoals:[...goals]});
}

function startFlow() {
  track('flow_start', {goals:[...goals]});
  // Solo "all resources" ‚Üí go straight there
  if (goals.includes('summer') && goals.length === 1) { window.location.href='resources.html'; return; }
  if (goals.includes('summer')) window.open('resources.html','_blank');
  // Solo "resume" ‚Üí go straight to resume builder
  if (goals.includes('tutoring') && goals.length === 1) { window.location.href='resume.html'; return; }
  if (goals.includes('tutoring') && goals.length > 1) window.open('resume.html','_blank');
  // Priority: regents > sat > college > cte
  if (goals.includes('regents')) goTo('s2');
  else if (goals.includes('sat'))     goTo('sat1');
  else if (goals.includes('college')) goTo('col1');
  else if (goals.includes('cte'))     goTo('cte1');
  else { buildResults(); goTo('s4');
  setTimeout(function() {
    saveOrPromptSignup({ goals: Array.from(goals), subject: selSubjs.join(','), results: { selSubjs: Array.from(selSubjs) } });
  }, 1500);
}
}

// ‚îÄ‚îÄ SUBJECT SELECTION ‚îÄ‚îÄ
function toggleSubj(id, el) {
  el.classList.toggle('selected');
  if (selSubjs.includes(id)) selSubjs = selSubjs.filter(s => s !== id);
  else selSubjs.push(id);
  document.getElementById('s2Next').disabled = selSubjs.length === 0;
}

function goS2b() {
  // Build unit picker for selected subjects
  selUnits = [];
  const allUnits = selSubjs.flatMap(sId => (SUBJS[sId]?.units||[]).map(u=>({...u, subjId:sId, subjName:SUBJS[sId].name, subjIcon:SUBJS[sId].icon})));
  const title = selSubjs.length === 1 ? `${SUBJS[selSubjs[0]].icon} ${SUBJS[selSubjs[0]].name} ‚Äî which units?` : 'Which units have you covered?';
  document.getElementById('s2bTitle').textContent = title;
  document.getElementById('unitGrid').innerHTML = allUnits.map(u => `
    <button class="subj-card" onclick="toggleUnit('${u.subjId}|${u.id}',this)" style="text-align:left">
      <div class="subj-card-check">‚úì</div>
      <div class="subj-icon">${u.emoji}</div>
      <div class="subj-name" style="font-size:12px;line-height:1.3">${u.name.replace(/Unit \d+: /,'')}</div>
      ${selSubjs.length > 1 ? '<div style="font-size:10px;color:var(--gray);margin-top:3px">'+u.subjIcon+' '+u.subjName+'</div>' : ''}
    </button>`).join('');
  goTo('s2b');
}

function toggleUnit(key, el) {
  el.classList.toggle('selected');
  if (selUnits.includes(key)) selUnits = selUnits.filter(u => u !== key);
  else selUnits.push(key);
  document.getElementById('s2bNext').disabled = selUnits.length === 0;
}

// ‚îÄ‚îÄ GRADE INPUT ‚îÄ‚îÄ
function goS3() {
  track('units_selected', {units:[...selUnits]});
  unitIdx = 0;
  renderUnitCard();
  goTo('s3');
}

function getUnitData(key) {
  const [subjId, unitId] = key.split('|');
  const subj = SUBJS[subjId];
  const unit = subj?.units?.find(u => u.id === unitId);
  return {subjId, subj, unit};
}

function renderUnitCard() {
  const key = selUnits[unitIdx];
  const {subjId, subj, unit} = getUnitData(key);
  const total = selUnits.length;
  const pct = Math.round(50 + (unitIdx / total) * 45);
  document.getElementById('pFill').style.width = pct + '%';
  document.getElementById('s3Sub').textContent = `Grade ${unitIdx+1} of ${total} ‚Äî ${subj.name}`;
  const saved = unitScores[key] || '';
  document.getElementById('s3Card').innerHTML = `
    <div class="score-wrap" style="margin-bottom:20px">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:4px">
        <span style="font-size:28px">${unit.emoji}</span>
        <div>
          <div class="score-subj-name" style="font-size:17px">${unit.name}</div>
          <div style="font-size:12px;color:var(--teal);font-weight:600">${unit.topic}</div>
        </div>
      </div>
      <div style="font-size:12px;color:var(--gray);margin-bottom:16px;padding:10px;background:var(--gray-light);border-radius:8px">
        üí° <em>${unit.tip}</em>
      </div>

      <div style="font-size:12px;font-weight:700;color:var(--gray);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Your grade on this unit:</div>

      <!-- NY scale tap buttons -->
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px">
        ${NY_SCALE.map(s=>{
          const clr = s.color==='red'?'#dc2626':s.color==='yellow'?'#d97706':'#059669';
          const isOn = saved===s.label;
          return `<button onclick="tapUnit('${key}','${s.label}',this)"
            style="padding:8px 14px;border:2px solid ${isOn?'var(--black)':clr};border-radius:20px;font-size:13px;font-weight:800;cursor:pointer;background:${isOn?'var(--black)':'white'};color:${isOn?'white':clr};font-family:'Instrument Sans',sans-serif;transition:all 0.15s"
            class="unit-scale-btn" data-key="${key}" data-lbl="${s.label}">${s.label}</button>`;
        }).join('')}
      </div>

      <div style="font-size:11px;color:var(--gray);margin-bottom:10px;text-align:center">‚Äî or enter a number ‚Äî</div>
      <input type="number" id="uInp" placeholder="e.g. 72" min="0" max="100"
        value="${/^\d+$/.test(saved)?saved:''}"
        style="width:100%;padding:12px;border:1.5px solid var(--border);border-radius:10px;font-size:16px;font-weight:700;text-align:center;font-family:'Instrument Sans',sans-serif;outline:none"
        oninput="unitScores['${key}']=this.value;clearScaleBtns('${key}')"
        onkeypress="if(event.key==='Enter')nextUnit()">
      <div id="gradePreview_${unitIdx}" style="text-align:center;font-size:13px;font-weight:700;margin-top:8px;min-height:20px"></div>
    </div>`;
  document.getElementById('backBtn').style.visibility = unitIdx === 0 ? 'hidden' : 'visible';
  const isLast = unitIdx === selUnits.length - 1;
  document.getElementById('s3Next').textContent = isLast ? 'See my results ‚Üí' : 'Next unit ‚Üí';
  updatePreview(key, unitIdx);
}

function tapUnit(key, lbl, btn) {
  unitScores[key] = lbl;
  document.querySelectorAll(`.unit-scale-btn[data-key="${key}"]`).forEach(b => {
    const isOn = b.dataset.lbl === lbl;
    const sc = NY_SCALE.find(s=>s.label===b.dataset.lbl);
    const clr = sc?.color==='red'?'#dc2626':sc?.color==='yellow'?'#d97706':'#059669';
    b.style.background = isOn ? 'var(--black)' : 'white';
    b.style.color = isOn ? 'white' : clr;
    b.style.borderColor = isOn ? 'var(--black)' : clr;
  });
  const inp = document.getElementById('uInp');
  if(inp) inp.value = '';
  updatePreview(key, unitIdx);
}

function clearScaleBtns(key) {
  document.querySelectorAll(`.unit-scale-btn[data-key="${key}"]`).forEach(b => {
    const sc = NY_SCALE.find(s=>s.label===b.dataset.lbl);
    const clr = sc?.color==='red'?'#dc2626':sc?.color==='yellow'?'#d97706':'#059669';
    b.style.background = 'white'; b.style.color = clr; b.style.borderColor = clr;
  });
  const inp = document.getElementById('uInp');
  if(inp) unitScores[key] = inp.value;
  updatePreview(key, unitIdx);
}

function updatePreview(key, idx) {
  const prev = document.getElementById('gradePreview_'+idx);
  if(!prev) return;
  const raw = unitScores[key];
  if(!raw){prev.innerHTML='';return;}
  const num = toNum(raw);
  if(num===null){prev.innerHTML='<span style="color:#dc2626">‚ùì invalid</span>';return;}
  const sc = scaleFromNum(num);
  const clr = sc.color==='red'?'#dc2626':sc.color==='yellow'?'#d97706':'#059669';
  prev.innerHTML = `<span style="color:${clr}">${sc.pass?'‚úì Passing':'‚úó Not passing yet'} ¬∑ ${sc.label} ¬∑ ${num}%</span>`;
}

function nextUnit() {
  const key = selUnits[unitIdx];
  const inp = document.getElementById('uInp');
  if(inp?.value) unitScores[key] = inp.value;
  if(!unitScores[key]) return toast('Please enter a grade first','error');
  if(unitIdx < selUnits.length - 1) { unitIdx++; renderUnitCard(); }
  else { track('grades_entered',{scores:{...unitScores}}); buildResults(); goTo('s4'); }
}

function prevUnit() {
  if(unitIdx > 0) { unitIdx--; renderUnitCard(); }
  else goTo('s2b');
}

// ‚îÄ‚îÄ BUILD RESULTS ‚îÄ‚îÄ
function buildResults() {
  document.getElementById('regentsResults').style.display = goals.includes('regents') ? 'block' : 'none';
  if (!goals.includes('regents') || !selUnits.length) return;

  const unitResults = selUnits.map(key => {
    const {subjId, subj, unit} = getUnitData(key);
    const raw = unitScores[key];
    const num = toNum(raw) ?? 0;
    const sc = scaleFromNum(num);
    return {key, subjId, subj, unit, num, sc};
  });

  const atRisk = unitResults.filter(r => !r.sc.pass).length;
  const onTrack = unitResults.filter(r => r.sc.color === 'green').length;

  let emoji, title, sub;
  if(atRisk===0 && onTrack===unitResults.length){emoji='üéâ';title="You're on track!";sub="Your unit grades look solid. Keep studying and you'll pass.";}
  else if(atRisk===0){emoji='‚ö†Ô∏è';title="You're passing ‚Äî don't get comfortable.";sub="Some units are borderline. A bit more work and you'll be safe.";}
  else if(atRisk===unitResults.length){emoji='üö®';title="You need to start studying now.";sub="Multiple units are below passing ‚Äî but you have time to turn it around.";}
  else{emoji='üìä';title=`${atRisk} unit${atRisk>1?'s':''} need your attention.`;sub="Focus on the red ones first ‚Äî they're pulling your grade down.";}

  document.getElementById('rEmoji').textContent=emoji;
  document.getElementById('rTitle').textContent=title;
  document.getElementById('rSub').textContent=sub;

  const colors={red:'#dc2626',yellow:'#d97706',green:'#059669'};
  const bgs={red:'#fff1f2',yellow:'#fffbeb',green:'#f0fdf4'};

  document.getElementById('rCards').innerHTML = unitResults.map(({subj, unit, num, sc}) => {
    const gap = !sc.pass ? `Need ${65-num} more points to pass` : sc.color==='yellow' ? `${num-65} pts above passing ‚Äî aim for P+ (75)` : 'On track!';
    return `<div class="rcard ${sc.color}">
      <div class="rcard-left">
        <div style="font-size:11px;font-weight:700;color:var(--gray);text-transform:uppercase;letter-spacing:1px;margin-bottom:2px">${subj.icon} ${subj.name}</div>
        <div class="rcard-subj">${unit.emoji} ${unit.name.replace(/Unit \d+: /,'')}</div>
        <div style="font-size:11px;color:${colors[sc.color]};font-weight:600;margin-bottom:2px">${unit.topic}</div>
        <div class="rcard-status" style="color:${colors[sc.color]}">${sc.pass?'‚úì':'‚úó'} ${sc.label} ‚Äî ${sc.pass?'Passing':'Not passing'}</div>
        <div class="rcard-action">${gap}</div>
      </div>
      <div class="rcard-score" style="color:${colors[sc.color]}">${sc.label}</div>
    </div>`;
  }).join('');

  // Study plan ‚Äî worst units first
  const needsWork = [...unitResults].sort((a,b)=>a.num-b.num).filter(r=>r.num<75).slice(0,3);
  if(!needsWork.length) {
    document.getElementById('studyPanel').innerHTML=`<div class="panel-title">üìñ Keep up your streak</div><p style="font-size:13px;color:var(--gray)">All units are passing! Do 15 min of review per unit each night before the exam.</p>`;
  } else {
    document.getElementById('studyItems').innerHTML = needsWork.map(({subj,unit,num,sc})=>{
      const dotC = sc.color;
      return `<div class="study-item">
        <div class="sdot ${dotC}"></div>
        <div>
          <div class="study-name">${unit.emoji} ${unit.name} ‚Äî <em>${unit.topic}</em></div>
          <div style="font-size:11px;color:var(--gray);margin:2px 0 4px">${unit.tip}</div>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <a href="${unit.link}" target="_blank" class="study-link">üìñ New Visions ‚Üí</a>
            <a href="${unit.khan}" target="_blank" class="study-link" style="color:var(--gray)">üìö RegentsPrep ‚Üí</a>
          </div>
        </div>
      </div>`;
    }).join('');
  }
  track('results_viewed',{goals:[...goals],atRisk,onTrack,total:unitResults.length});
  // Show resume section if tutoring goal selected
  const resumeSection = document.getElementById('resumeSection');
  if (resumeSection) resumeSection.style.display = goals.includes('tutoring') ? 'block' : 'none';
}


// ‚ïê‚ïê SIGNUP MODAL ‚ïê‚ïê
let pendingUrl = null;
let signupCount = 0; // track how many times they've dismissed

function interceptLink(url, context) {
  // Just open directly now ‚Äî auth modal handles saving separately
  if (url.startsWith('http')) window.open(url, '_blank');
  else window.location.href = url;
  return;
  pendingUrl = url;
  signupCount++;
  track('link_intercepted', {url, context, count: signupCount});

  // Customize modal per context
  const modal = document.getElementById('signupModal');
  const configs = {
    resume:    {emoji:'üìÑ', title:'Save your resume before you go', sub:'Sign up free to save your resume and come back to edit it anytime.'},
    resources: {emoji:'üìö', title:'Save your results + get alerts', sub:'Create a free account to save your scores and get internship deadline reminders.'},
    study:     {emoji:'üéØ', title:'Save your study plan', sub:'Sign up to get your personalized daily study plan and track improvement over time.'},
    default:   {emoji:'‚ú®', title:'Save everything before you go', sub:'Create a free account to keep your results and unlock your full dashboard.'},
  };
  const cfg = configs[context] || configs.default;
  document.getElementById('modalEmoji').textContent = cfg.emoji;
  document.getElementById('modalTitle').textContent = cfg.title;
  document.getElementById('modalSub').textContent = cfg.sub;

  // Update signup button destination with context
  document.getElementById('modalSignupBtn').href = `app.html?from=${context}`;

  modal.style.display = 'flex';
  document.body.style.overflow = 'hidden';
}

function closeModal() {
  document.getElementById('signupModal').style.display = 'none';
  document.body.style.overflow = '';
}

function continueWithoutSaving() {
  closeModal();
  track('signup_skipped', {url: pendingUrl, count: signupCount});
  if (pendingUrl) {
    // External resource links open in new tab, internal pages navigate
    if (pendingUrl.startsWith('http')) window.open(pendingUrl, '_blank');
    else window.location.href = pendingUrl;
    pendingUrl = null;
  }
}

// ‚îÄ‚îÄ MINI RESUME PREVIEW ‚îÄ‚îÄ
function updateMiniResume() {
  const name = document.getElementById('rqName')?.value.trim();
  const grade = document.getElementById('rqGrade')?.value;
  const skill = document.getElementById('rqSkill')?.value.trim();
  const preview = document.getElementById('miniResumePreview');
  if (!preview) return;
  if (name || skill) {
    preview.style.display = 'block';
    document.getElementById('mrName').textContent = name || 'Your Name';
    document.getElementById('mrGrade').textContent = grade ? `High School Student ¬∑ ${grade}` : 'High School Student';
    document.getElementById('mrSkill').textContent = skill || '‚Äî';
  } else {
    preview.style.display = 'none';
  }
}



const RES = [
  // ‚îÄ‚îÄ INTERNSHIPS ‚îÄ‚îÄ
  {
    cat:'internship', featured:true,
    icon:'üíº', iconBg:'#fef3c7',
    name:'SYEP ‚Äî Summer Youth Employment Program',
    org:'NYC Dept. of Youth & Community Development',
    desc:"NYC's flagship paid summer jobs program. Work at hospitals, tech firms, nonprofits, city agencies ‚Äî up to $18.84/hr. The largest youth employment program in the US. Ages 14‚Äì24.",
    tags:['paid','hot'],
    btn:'Apply at nyc.gov ‚Üí',
    url:'https://www.nyc.gov/site/dycd/services/jobs-internships/summer-youth-employment-program-syep.page',
    kw:'syep summer jobs paid work nyc age 14'
  },
  {
    cat:'internship',
    icon:'‚ùÑÔ∏è', iconBg:'#eff6ff',
    name:'Snow.day ‚Äî Search 500+ Free Programs',
    org:'Independent student tool',
    desc:'The best search engine for free summer programs. Filter by age, subject (STEM, arts, law, business), stipend, and location. Built for low-income and underrepresented students.',
    tags:['free'],
    btn:'snow.day ‚Üí',
    url:'https://snow.day',
    kw:'snow day free programs search summer 500'
  },
  {
    cat:'internship',
    icon:'üîß', iconBg:'#e6f7f2',
    name:'Hk Maker Lab ‚Äî Columbia University',
    org:'Columbia School of Engineering',
    desc:'Free 5-week engineering design program at Columbia. Students prototype real solutions with Columbia mentors. Priority for low-income students. Grades 10‚Äì11.',
    tags:['free','stem'],
    btn:'hkmakerlab.columbia.edu ‚Üí',
    url:'https://hkmakerlab.columbia.edu',
    kw:'hk maker lab columbia engineering free stem grade 10 11'
  },
  {
    cat:'internship',
    icon:'üî¨', iconBg:'#f5f3ff',
    name:'NYAS Junior Academy',
    org:'New York Academy of Sciences',
    desc:'Virtual mentorship pairing students with real scientists and engineers. Work on science challenges, build research skills, and strengthen your college application ‚Äî all online, free.',
    tags:['free','stem'],
    btn:'Apply at nyas.org ‚Üí',
    url:'https://www.nyas.org/programs/global-stem-alliance/junior-academy/',
    kw:'nyas junior academy science mentorship virtual stem'
  },
  {
    cat:'internship',
    icon:'üß¨', iconBg:'#f0fdf4',
    name:'NYC Science Research Mentoring Consortium',
    org:'AMNH ¬∑ Cold Spring Harbor ¬∑ NY Botanical Garden',
    desc:'100+ hours of mentored research at world-class institutions. Competitive ‚Äî GPA 85+ recommended. One of the strongest college application boosters available to students.',
    tags:['free','stem'],
    btn:'scienceresearchmentoring.org ‚Üí',
    url:'https://scienceresearchmentoring.org',
    kw:'science research mentoring amnh cold spring harbor competitive gpa 85'
  },

  // ‚îÄ‚îÄ SCHOLARSHIPS ‚îÄ‚îÄ
  {
    cat:'scholarship', featured:true,
    icon:'üéì', iconBg:'#e6f7f2',
    name:'CUNY Excelsior ‚Äî Free College Tuition',
    org:'City University of New York',
    desc:'Families earning under $125,000/year may attend any of 25 CUNY campuses tuition-free. File FAFSA first, then apply at hesc.ny.gov. Covers Baruch, Hunter, Brooklyn College, and more.',
    tags:['free'],
    btn:'Apply at hesc.ny.gov ‚Üí',
    url:'https://www.hesc.ny.gov',
    kw:'cuny excelsior free college tuition 125k family income'
  },
  {
    cat:'scholarship',
    icon:'üìã', iconBg:'#eff6ff',
    name:'FAFSA ‚Äî Free Federal Student Aid',
    org:'U.S. Department of Education',
    desc:'Every student should file ‚Äî even if you think you won\'t qualify. Unlocks Pell Grants (up to $7,395/yr free money), work-study, and loans. Required for Excelsior. Opens December 1.',
    tags:['free'],
    btn:'Apply at studentaid.gov ‚Üí',
    url:'https://studentaid.gov',
    kw:'fafsa federal financial aid pell grant free money student'
  },
  {
    cat:'scholarship',
    icon:'üèÜ', iconBg:'#fef3c7',
    name:'Fastweb ‚Äî 1.5M+ Scholarships',
    org:'Fastweb.com',
    desc:'The largest free scholarship database. Build a profile and get matched to awards based on your grades, interests, background, and location. Many NYC-specific scholarships included.',
    tags:['free'],
    btn:'fastweb.com ‚Üí',
    url:'https://www.fastweb.com',
    kw:'fastweb scholarship search free money personalized 1.5 million'
  },
  {
    cat:'scholarship',
    icon:'‚ú®', iconBg:'#f5f3ff',
    name:'Bold.org ‚Äî Including No-Essay Scholarships',
    org:'Bold.org',
    desc:'Apply to scholarships that require no essay ‚Äî just your profile. Great for maximizing applications with less time. Also has larger essay-based awards. Rolling deadlines.',
    tags:['free'],
    btn:'bold.org ‚Üí',
    url:'https://bold.org',
    kw:'bold no essay scholarship easy apply free money award'
  },
  {
    cat:'scholarship',
    icon:'üìà', iconBg:'#f0fdf4',
    name:'Raise.me ‚Äî Earn Micro-Scholarships Now',
    org:'Raise.me',
    desc:'Earn micro-scholarships starting in 9th grade ‚Äî for your GPA, activities, volunteer work, and AP courses. Stack them up before applying. 300+ colleges participate including CUNY.',
    tags:['free'],
    btn:'raise.me ‚Üí',
    url:'https://www.raise.me',
    kw:'raise.me micro scholarship gpa activities 9th grade earn early'
  },

  // ‚îÄ‚îÄ SAT / ACT ‚îÄ‚îÄ
  {
    cat:'sat', featured:true,
    icon:'üìù', iconBg:'#f5f3ff',
    name:'Official SAT Prep ‚Äî Free on Khan Academy',
    org:'College Board + Khan Academy',
    desc:'The College Board\'s official SAT prep ‚Äî completely free. Personalized to your PSAT results, 8 full-length practice tests. Students who practice 20hrs improve by ~115 points on average.',
    tags:['free','sat'],
    btn:'Start free SAT prep ‚Üí',
    url:'https://www.khanacademy.org/sat',
    kw:'sat prep khan academy official college board free personalized psat'
  },
  {
    cat:'sat',
    icon:'üíª', iconBg:'#eff6ff',
    name:'Bluebook ‚Äî Full Digital SAT Practice Tests',
    org:'College Board',
    desc:'The official app for the digital SAT. Full-length practice tests in the exact format of the real exam ‚Äî same tools, same timing, same adaptive difficulty. Best way to simulate test day.',
    tags:['free','sat'],
    btn:'Download Bluebook ‚Üí',
    url:'https://bluebook.collegeboard.org',
    kw:'bluebook digital sat practice test official full length'
  },
  {
    cat:'sat',
    icon:'üìä', iconBg:'#fff7ed',
    name:'Free ACT Practice Tests ‚Äî Official',
    org:'ACT.org',
    desc:'Free official ACT prep: full practice tests, sample questions, score reports. Tests English, Math, Reading, and Science Reasoning. Many students score better on ACT than SAT ‚Äî try both.',
    tags:['free','act'],
    btn:'Free ACT prep ‚Üí',
    url:'https://www.act.org/content/act/en/products-and-services/the-act/test-preparation/free-act-test-prep.html',
    kw:'act prep free practice test official science reasoning english math'
  },
  {
    cat:'sat',
    icon:'üè´', iconBg:'#f0fdf4',
    name:'NYC DOE Free SAT & ACT Prep + Fee Waivers',
    org:'NYC Department of Education',
    desc:'Free SAT/ACT prep through NYC public schools. Income-eligible students can take the SAT for free with a fee waiver. Ask your school counselor in September.',
    tags:['free','sat','act'],
    btn:'NYC DOE info ‚Üí',
    url:'https://www.schools.nyc.gov/learning/student-support/academic-support/standardized-test-prep',
    kw:'nyc doe sat act prep free class fee waiver income eligible counselor'
  },

  // ‚îÄ‚îÄ COLLEGE PREP ‚îÄ‚îÄ
  {
    cat:'college',
    icon:'üèõÔ∏è', iconBg:'#f0fdf4',
    name:'NYC College Access Centers ‚Äî Free 1-on-1 Help',
    org:'NYC Department of Education',
    desc:'Free college counseling across all 5 boroughs. FAFSA help, essay review, financial aid appeals, scholarship searches. No appointment needed at most locations. Open year-round.',
    tags:['free'],
    btn:'Find center near you ‚Üí',
    url:'https://www.schools.nyc.gov/enrollment/high-school/college-access-centers',
    kw:'nyc college access counselor help fafsa essay application free boroughs'
  },
  {
    cat:'college',
    icon:'üìù', iconBg:'#eff6ff',
    name:'Common App ‚Äî Apply to 1,000+ Colleges',
    org:'Common Application Inc.',
    desc:'Apply to 1,000+ colleges with one application and one set of essays. Used by most 4-year colleges outside CUNY. Start in junior year ‚Äî deadlines run November 1 to January 1.',
    tags:['free'],
    btn:'commonapp.org ‚Üí',
    url:'https://www.commonapp.org',
    kw:'common app college application 1000 schools university apply essay'
  },
  {
    cat:'college',
    icon:'üéì', iconBg:'#fef3c7',
    name:'CUNY College Now ‚Äî Free College Credits',
    org:'City University of New York',
    desc:'Take real CUNY college courses while still in high school ‚Äî completely free. Credits count toward your degree when you enroll. English, Math, Science, Business. Grades 10‚Äì12.',
    tags:['free'],
    btn:'Explore College Now ‚Üí',
    url:'https://www.cuny.edu/about/administration/offices/k16/college-now/',
    kw:'cuny college now dual enrollment free credit high school grade 10 11 12'
  },
  {
    cat:'college',
    icon:'üíª', iconBg:'#f0fdf4',
    name:'P-TECH ‚Äî Free Associate Degree in 6 Years',
    org:'NYC DOE + IBM + CUNY',
    desc:'6-year program combining high school with a free CUNY associate\'s degree in tech, health, or business. Graduate with a diploma AND a 2-year college degree. IBM mentorship built in.',
    tags:['free','stem'],
    btn:'ptech.org ‚Üí',
    url:'https://www.ptech.org',
    kw:'ptech pathways technology early college degree associate stem ibm grade 9'
  },

  // ‚îÄ‚îÄ SELF-STUDY ‚îÄ‚îÄ
  {
    cat:'study',
    icon:'üü¢', iconBg:'#f0fdf4',
    name:'Khan Academy ‚Äî Free Lessons for Every Subject',
    org:'Khan Academy',
    desc:'World-class free education for every subject. Personalized learning paths for Algebra, ELA, Biology, US History, and SHSAT. ZenEd\'s study plan links directly to your weakest topics.',
    tags:['free'],
    btn:'khanacademy.org ‚Üí',
    url:'https://www.khanacademy.org',
    kw:'khan academy math science history ela free videos practice all subjects'
  },
  {
    cat:'study', featured:true,
    icon:'üî¨', iconBg:'#e6f7f2',
    name:'LabXchange ‚Äî Harvard Free Science Labs',
    org:'Harvard University ¬∑ LabXchange.org',
    desc:'Harvard\'s free interactive science platform. Life sciences collection for grades 9-12 covers genetics, evolution, ecosystems, and cell biology with real virtual labs and simulations. Perfect for Living Environment Regents.',
    tags:['free','stem'],
    btn:'Life Sciences ‚Üí',
    url:'https://www.labxchange.org/c/ngss?subject=life-sciences&grade=grades-9-12',
    kw:'labxchange harvard science lab simulation ngss life sciences grades 9 12 biology'
  },
  {
    cat:'study',
    icon:'üé•', iconBg:'#fff7ed',
    name:'LabXchange ‚Äî Annenberg Science Videos',
    org:'LabXchange / Annenberg Foundation',
    desc:'High-quality science video lessons from the Annenberg Foundation, now on LabXchange. Biology, chemistry, physics, earth science. Note: Annenberg Learner (learner.org) is closing ‚Äî use this link.',
    tags:['free','stem'],
    btn:'Access on LabXchange ‚Üí',
    url:'https://www.labxchange.org/org/annenberglearner',
    kw:'labxchange annenberg learner science biology chemistry physics video lessons'
  },
  {
    cat:'study',
    icon:'üìñ', iconBg:'#fdf4ff',
    name:'Regents Prep + Official Past Exams',
    org:'RegentsPrep.org ¬∑ NYSED',
    desc:'Free NY-specific practice for every Regents exam. Download real past exams from NYSED. Covers Algebra 1, ELA, Living Environment, US History, and more. Pairs with ZenEd\'s study plan.',
    tags:['free'],
    btn:'regentsprep.org ‚Üí',
    url:'https://www.regentsprep.org',
    kw:'regents prep past exams algebra ela us history biology nysed free'
  },
  {
    cat:'study',
    icon:'üß™', iconBg:'#f0fdf4',
    name:'New Visions Biology ‚Äî Free Full Curriculum',
    org:'New Visions for Public Schools',
    desc:'Complete free Biology curriculum ‚Äî all 6 units from Marathon Runner to Woolly Mammoth. Student and teacher materials included. Aligned with Living Environment Regents and ZenEd\'s grade tracking.',
    tags:['free','stem'],
    btn:'Access curriculum ‚Üí',
    url:'https://www.newvisions.org/curriculum/science/biology',
    kw:'new visions biology curriculum units living environment regents marathon runner bacteria evolution'
  },

  // ‚îÄ‚îÄ PORTRAIT OF A GRADUATE ‚îÄ‚îÄ
  {
    cat:'graduate', featured:true,
    icon:'üèÖ', iconBg:'#fef3c7',
    name:'Portrait of a Graduate ‚Äî NY\'s New Graduation',
    org:'New York State Education Department',
    desc:'NY State is replacing required Regents with real-world skills by 2029-30. New pathways launch 2027-28: portfolios, projects, internships, CTE credentials, presentations. Regents become optional.',
    tags:['grad','new'],
    btn:'NYSED.gov ‚Üí',
    url:'https://www.nysed.gov/next-generation-learning-standards',
    kw:'portrait graduate nys regents optional 2029 2030 project portfolio graduation framework'
  },
  {
    cat:'graduate',
    icon:'üå±', iconBg:'#e6f7f2',
    name:'Portrait ‚Äî 6 Competencies Explained',
    org:'NYC Schools + NYSED',
    desc:'The new framework values: Biliteracy, Civic Readiness, Computational Thinking, Creativity, Critical Analysis, and Integrated Wellness. Schools are building portfolios and projects that will count now.',
    tags:['grad'],
    btn:'Official PDF ‚Üí',
    url:'https://www.nysed.gov/sites/default/files/programs/curriculum-instruction/portrait-of-a-graduate.pdf',
    kw:'portrait competencies biliteracy civic computational creativity critical wellness portfolio project'
  },
  {
    cat:'graduate',
    icon:'‚öôÔ∏è', iconBg:'#fff7ed',
    name:'NYC CTE Programs ‚Äî 400+ Career Pathways',
    org:'NYC Department of Education',
    desc:'Free career and technical programs at NYC high schools. Industry certifications and real work experience in Tech, Health, Architecture, Business, Culinary, Law, Engineering. Counts toward new graduation.',
    tags:['free'],
    btn:'Explore CTE ‚Üí',
    url:'https://www.schools.nyc.gov/learning/programs/career-and-technical-education',
    kw:'cte career technical education vocational pathway health tech business arts culinary law'
  },
  {
    cat:'cte',
    icon:'‚öôÔ∏è', iconBg:'#fff7ed',
    name:'NYC CTE Programs ‚Äî 400+ Career Pathways',
    org:'NYC Department of Education',
    desc:'Free career and technical programs at NYC high schools. Industry certifications and real work experience in Tech, Health, Architecture, Business, Culinary, Law, Engineering. Counts toward new graduation.',
    tags:['free'],
    btn:'Explore CTE ‚Üí',
    url:'https://www.schools.nyc.gov/learning/programs/career-and-technical-education',
    kw:'cte career technical education vocational'
  },
  {
    cat:'cte',
    icon:'üíª', iconBg:'#f0fdf4',
    name:'P-TECH ‚Äî Free Associate Degree + IBM Mentorship',
    org:'NYC DOE + IBM + CUNY',
    desc:'6-year program: high school diploma + free CUNY associate\'s degree in 6 years. IBM mentors included. No admissions test. Apply in 8th grade. Strongest tech CTE pathway in NYC.',
    tags:['free','stem'],
    btn:'ptech.org ‚Üí',
    url:'https://www.ptech.org',
    kw:'ptech ibm associate degree cte stem tech free'
  },  ,
  {
    cat:'internship',
    icon:'üß†', iconBg:'#fdf4ff',
    name:'BrainYAC ‚Äî Columbia Zuckerman Institute',
    org:'Columbia University Zuckerman Institute',
    desc:'Free neuroscience program for high school students at Columbia. Hands-on brain science research, lab visits, and mentorship from Columbia scientists. Strong college application booster.',
    tags:['free','stem'],
    btn:'Apply at Columbia ‚Üí',
    url:'https://zuckermaninstitute.columbia.edu/brainyac',
    kw:'brainyac columbia zuckerman neuroscience brain lab free stem high school'
  }  ,
  {
    cat:'cte',
    icon:'üåÜ', iconBg:'#fef3c7',
    name:'Growing Up NYC ‚Äî CTE Career Programs Guide',
    org:'NYC Mayor\'s Office',
    desc:'City-wide guide to CTE and career programs for NYC youth ‚Äî searchable by interest, industry, and grade level. Covers all 5 boroughs with deadlines and application links.',
    tags:['free'],
    btn:'growingupnyc.cityofnewyork.us ‚Üí',
    url:'https://growingupnyc.cityofnewyork.us/programs/career-technical-education/',
    kw:'growing up nyc cte career guide borough youth interest searchable'
  }  ,
  {cat:'internship',icon:'üß†',name:'BrainYAC ‚Äî Columbia Zuckerman',tags:['free','stem'],url:'https://zuckermaninstitute.columbia.edu/brainyac'},
  {cat:'cte',icon:'üåÜ',name:'Growing Up NYC ‚Äî CTE Guide',tags:['free'],url:'https://growingupnyc.cityofnewyork.us/programs/career-technical-education/'}
];
let activeResCat = 'all';

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SAT FLOW
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let satStatus=null, satWeakSection=null, satScore=null, satTarget=null, satTimeframe=null;

const SAT_DATA = {
  math:{label:'Math',icon:'üìê',tip:'SAT Math is 44 questions in 70 min. No calculator on module 1. Algebra covers ~35% ‚Äî start there.',
    modules:[
      {name:'Algebra & Linear Functions',link:'https://www.regentsprep.org/algebra/',desc:'Highest-value topic ‚Äî ~35% of SAT Math'},
      {name:'Advanced Math & Quadratics',link:'https://www.regentsprep.org/algebra2/',desc:'Quadratics, polynomials, exponential functions'},
      {name:'Problem Solving & Data',link:'https://www.regentsprep.org/algebra2/',desc:'Percentages, ratios, scatter plots'},
      {name:'Geometry & Trigonometry',link:'https://www.regentsprep.org/geometry/',desc:'Area, volume, angles, basic trig'},
    ]},
  reading:{label:'Reading & Writing',icon:'üìñ',tip:'54 questions in 64 min. Each has its own short passage ‚Äî great for pacing. Grammar questions are the fastest wins.',
    modules:[
      {name:'Information & Ideas',link:'https://satsuite.collegeboard.org/digital/digital-practice-preparation/practice-tests',desc:'Main idea, details, inference ‚Äî most questions'},
      {name:'Craft & Structure',link:'https://satsuite.collegeboard.org/digital/digital-practice-preparation/practice-tests',desc:'Vocabulary in context, text structure, purpose'},
      {name:'Expression of Ideas',link:'https://satsuite.collegeboard.org/digital/digital-practice-preparation/practice-tests',desc:'Transitions, rhetorical synthesis, rewriting'},
      {name:'Standard English Conventions',link:'https://satsuite.collegeboard.org/digital/digital-practice-preparation/practice-tests',desc:'Punctuation, sentence boundaries ‚Äî fastest to improve'},
    ]},
  both:{label:'Both Sections',icon:'‚öñÔ∏è',tip:'Take a full Bluebook practice test first ‚Äî your score gap tells you exactly where to focus.',
    modules:[
      {name:'Bluebook Full Practice Test',link:'https://bluebook.collegeboard.org',desc:'Take this first ‚Äî see which score is lower'},
      {name:'RegentsPrep SAT Personalized',link:'https://satsuite.collegeboard.org/digital/digital-practice-preparation/practice-tests',desc:'Connect PSAT scores for instant custom plan'},
      {name:'Math: Algebra & Functions',link:'https://www.regentsprep.org/algebra/',desc:'Highest-value Math topics'},
      {name:'Reading: Grammar & Editing',link:'https://satsuite.collegeboard.org/digital/digital-practice-preparation/practice-tests',desc:'Fastest Reading/Writing gains'},
    ]},
  time:{label:'Timing & Anxiety',icon:'‚è±Ô∏è',tip:'Timing only improves with timed practice. Take 4+ full timed tests. Review every wrong answer after each one.',
    modules:[
      {name:'SAT Timing Strategy',link:'https://satsuite.collegeboard.org/digital/digital-practice-preparation/practice-tests',desc:'When to skip, when to guess, how to pace'},
      {name:'Bluebook Timed Practice',link:'https://bluebook.collegeboard.org',desc:'Same app used on test day ‚Äî 4 free full tests'},
      {name:'Test Anxiety Techniques',link:'https://satsuite.collegeboard.org/digital/digital-practice-preparation/practice-tests',desc:'Breathing, mindset, elimination strategies'},
    ]},
};

const SAT_SCHEDULES = {
  '2weeks':{label:'2 weeks',daily:90,plan:['Days 1‚Äì3: Full Bluebook practice test ‚Äî identify exactly which question types you miss','Days 4‚Äì7: RegentsPrep ‚Äî drill ONLY your 2 weakest question types, nothing else','Days 8‚Äì11: 2 more full timed Bluebook tests, review every wrong answer the same day','Days 12‚Äì14: Light review only, sleep 8hrs, no cramming the night before']},
  '1month':{label:'1 month',daily:60,plan:['Week 1: Full Bluebook test + connect PSAT score to Khan for personalized plan','Week 2: RegentsPrep personalized ‚Äî 60 min/day focused on weak topics only','Week 3: Second full Bluebook test, compare to Week 1, adjust your focus','Week 4: Final practice test + review only weak question types, rest before test day']},
  '3months':{label:'3 months',daily:45,plan:['Month 1: Khan diagnostic + 2 Bluebook tests, build section foundations (45 min/day)','Month 2: Section deep work ‚Äî alternate Math and Reading weeks, track % correct','Month 3: Full test every 2 weeks, review wrong answers, polish weak spots only']},
  'long':{label:'6+ months',daily:30,plan:['Months 1‚Äì2: Khan Algebra 1 + Reading grammar foundations (30 min/day is enough)','Months 3‚Äì4: Monthly Bluebook test, build section by section from your lowest scores','Months 5‚Äì6: Intensive ‚Äî 2 timed tests/month, targeted drilling on remaining weak areas','Bonus: Take PSAT in October ‚Äî free data AND qualifies for National Merit Scholarship']},
};

function setSATStatus(val, el) {
  satStatus = val;
  document.querySelectorAll('#sat1 .subj-card').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected');
  document.getElementById('sat1Next').disabled = false;
  const isACT = val==='act', hasScore = val!=='never';
  const sat2 = document.getElementById('sat2Content');
  if (!hasScore) {
    sat2.innerHTML = `<div class="step-label">How much time until your test?</div>
      <p style="font-size:13px;color:var(--gray);text-align:center;margin-bottom:20px">We'll build a realistic study schedule based on your timeline.</p>
      <div class="subj-grid" style="grid-template-columns:1fr 1fr;max-width:480px;margin:0 auto 20px">
        ${Object.entries(SAT_SCHEDULES).map(([k,v])=>`<button class="subj-card" onclick="setSATTimeframe('${k}',this)"><div class="subj-card-check">‚úì</div><div class="subj-name">${v.label}</div></button>`).join('')}
      </div>`;
  } else {
    sat2.innerHTML = `<div class="step-label">What's your current ${isACT?'ACT':'SAT'} score?</div>
      <p style="font-size:13px;color:var(--gray);text-align:center;margin-bottom:16px">${isACT?'ACT scored 1‚Äì36. Avg NYC public school: ~18':'SAT scored 400‚Äì1600. Avg NYC public school: ~990'}</p>
      <div class="score-wrap" style="max-width:400px;margin:0 auto 16px">
        <input type="number" id="satScoreInp" class="score-input" placeholder="${isACT?'22':'1050'}" min="${isACT?1:400}" max="${isACT?36:1600}" style="font-size:42px" oninput="satScore=parseInt(this.value)">
        <div class="score-hint">${isACT?'CUNY: 18+ ¬∑ SUNY: 20+ ¬∑ competitive private: 27+':'CUNY: 1000+ ¬∑ SUNY: 1050+ ¬∑ competitive private: 1200+'}</div>
        <div style="margin-top:14px">
          <label style="font-size:12px;font-weight:700;color:var(--gray);display:block;margin-bottom:6px">Target score</label>
          <input type="number" id="satTargetInp" class="score-input" placeholder="${isACT?'26':'1200'}" min="${isACT?1:400}" max="${isACT?36:1600}" style="font-size:32px;color:var(--teal)" oninput="satTarget=parseInt(this.value)">
        </div>
      </div>
      <div style="max-width:400px;margin:0 auto 16px">
        <label style="font-size:12px;font-weight:700;color:var(--gray);display:block;margin-bottom:8px">Time until your next test:</label>
        <div class="subj-grid" style="grid-template-columns:1fr 1fr">
          ${Object.entries(SAT_SCHEDULES).map(([k,v])=>`<button class="subj-card" style="padding:12px" onclick="setSATTimeframe('${k}',this)"><div class="subj-card-check">‚úì</div><div class="subj-name">${v.label}</div></button>`).join('')}
        </div>
      </div>`;
  }
}

function setSATTimeframe(val, el) {
  satTimeframe = val;
  document.querySelectorAll('#sat2 .subj-card').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected');
}

function toggleSATSection(val, el) {
  satWeakSection = val;
  document.querySelectorAll('#sat3 .subj-card').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected');
  document.getElementById('sat3Next').disabled = false;
}

function buildSATResults() {
  const section = SAT_DATA[satWeakSection] || SAT_DATA.both;
  const schedule = SAT_SCHEDULES[satTimeframe] || SAT_SCHEDULES['1month'];
  const isACT = satStatus==='act';
  const gap = (satScore && satTarget) ? satTarget-satScore : null;
  const colC = satScore ? (isACT?(satScore>=27?'green':satScore>=20?'yellow':'red'):(satScore>=1200?'green':satScore>=1000?'yellow':'red')) : null;

  let html = `<button class="btn-back-flow" onclick="goTo('sat3')">‚Üê Back</button>
  <div class="result-hero">
    <div class="result-emoji">üéØ</div>
    <div class="result-title">Your ${isACT?'ACT':'SAT'} Study Plan</div>
    <div class="result-sub">${gap!==null&&gap>0?`Current: ${satScore} ‚Üí Target: ${satTarget} ¬∑ Need +${gap} points`:'Personalized plan based on your timeline and weak areas'}</div>
  </div>`;

  if (satScore && colC) {
    const msg = isACT
      ? (satScore>=27?'Strong ‚Äî competitive for selective schools':satScore>=20?'Solid ‚Äî meets CUNY/SUNY requirements':'Needs work ‚Äî focused prep adds 4‚Äì6 points fast')
      : (satScore>=1200?'Strong ‚Äî competitive for selective schools':satScore>=1000?'Meets CUNY/SUNY minimum ‚Äî room to grow':'Below average ‚Äî focused prep can add 150+ points');
    html += `<div class="rcard ${colC}" style="margin-bottom:14px">
      <div class="rcard-left">
        <div class="rcard-subj">${isACT?'ACT':'SAT'} Current Score</div>
        <div class="rcard-status">${msg}</div>
        ${gap!==null&&gap>0?`<div class="rcard-action">+${gap} points to reach your target</div>`:''}
      </div><div class="rcard-score">${satScore}</div>
    </div>`;
  }

  html += `<div style="background:#fffbeb;border:1.5px solid #f59e0b;border-radius:14px;padding:14px 16px;margin-bottom:14px">
    <div style="font-size:13px;font-weight:800;margin-bottom:5px">üí∞ Take the test for free ‚Äî fee waivers</div>
    <div style="font-size:12px;color:#374151;line-height:1.7">Free/reduced lunch = <strong>2 free SAT tests</strong> and <strong>4 free ACT tests</strong>. Ask your counselor for a fee waiver code before registering. Also unlocks fee waivers for 20+ college applications.</div>
  </div>`;

  html += `<div class="panel" style="margin-bottom:14px">
    <div class="panel-title">üìÖ Your ${schedule.label} plan (${schedule.daily} min/day)</div>
    ${schedule.plan.map((step,i)=>`<div class="study-item"><div class="sdot ${i===0?'red':i===schedule.plan.length-1?'green':'yellow'}"></div><div><div class="study-name">${step}</div></div></div>`).join('')}
  </div>`;

  html += `<div class="panel" style="margin-bottom:14px">
    <div class="panel-title">${section.icon} Focus: ${section.label}</div>
    <div style="font-size:12px;color:var(--gray);background:var(--gray-light);border-radius:8px;padding:8px 12px;margin-bottom:10px">üí° ${section.tip}</div>
    ${section.modules.map(m=>`<div class="study-item"><div class="sdot red"></div><div>
      <div class="study-name">${m.name}</div>
      <div style="font-size:11px;color:var(--gray);margin:2px 0 4px">${m.desc}</div>
      <a href="${m.link}" target="_blank" class="study-link">Start studying ‚Üí</a>
    </div></div>`).join('')}
  </div>`;

  html += `<div class="panel" style="margin-bottom:14px">
    <div class="panel-title">üîë 3 essential tools ‚Äî all free</div>
    ${[
      {n:'RegentsPrep SAT ‚Äî Official & Free',d:'Made with College Board. Connect PSAT scores for instant personalized plan.',l:'https://satsuite.collegeboard.org/digital/digital-practice-preparation/practice-tests'},
      {n:'Bluebook ‚Äî Official Digital Practice Tests',d:'Same app as test day. 4 full free tests. Take every single one.',l:'https://bluebook.collegeboard.org'},
      {n:'NYC DOE SAT/ACT Prep + Fee Waivers',d:'Free NYC prep programs and test fee waivers for public school students.',l:'https://www.schools.nyc.gov/learning/student-journey/college-and-career-planning/sat-act'},
    ].map(r=>`<div class="study-item"><div class="sdot green"></div><div>
      <div class="study-name">${r.n}</div>
      <div style="font-size:11px;color:var(--gray);margin:2px 0 4px">${r.d}</div>
      <a href="${r.l}" target="_blank" class="study-link">Open ‚Üí</a>
    </div></div>`).join('')}
  </div>`;

  document.getElementById('s4').querySelector('.flow-section').innerHTML = html;
  buildResultsCommon();
  goTo('s4');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CTE FLOW
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let cteIndustry=null, cteGoal=null;

const CTE_DATA = {
  tech:{label:'Technology & Coding',icon:'üíª',salary:'$65K‚Äì$110K',
    certifications:['CompTIA IT Fundamentals (ITF+) ‚Äî entry level, $0 study materials','Google IT Support Certificate (Coursera ‚Äî free for students)','AWS Cloud Practitioner ‚Äî in-demand cloud cert','CompTIA A+ ‚Äî most recognized IT cert for jobs','Cybersecurity Fundamentals (Cisco Networking Academy ‚Äî free)'],
    programs:[
      {name:'P-TECH ‚Äî Free Associate Degree + IBM mentorship',link:'https://www.ptech.org',note:'6-year program: HS diploma + free CUNY associate degree + guaranteed IBM job interview. 30+ NYC schools.'},
      {name:'CUNY Tech Talent Pipeline',link:'https://talem.nyc',note:'Free coding bootcamp partnerships + paid internships at NYC tech companies. No experience needed.'},
      {name:'NYC CS4All ‚Äî Computer Science for All',link:'https://www.schools.nyc.gov/learning/programs/computer-science-for-all',note:'Free CS courses in NYC public schools ‚Äî coding, networks, cybersecurity, game design.'},
      {name:'SYEP Tech Track',link:'https://www.nyc.gov/site/dycd/services/jobs-internships/summer-youth-employment-program-syep.page',note:'Paid summer internships at NYC tech companies for ages 14‚Äì24. Apply every January.'},
      {name:'NYC CTE Technology Programs',link:'https://www.schools.nyc.gov/learning/student-journey/career-connected-learning/career-and-technical-education-cte/',note:'400+ tech CTE seats across NYC high schools: networks, cybersecurity, web dev, game design.'},
    ],
    colleges:['CUNY City Tech ‚Äî Computer Systems Technology (Excelsior ‚úì)','CUNY Queensborough ‚Äî Computer Information Systems (Excelsior ‚úì)','CUNY BMCC ‚Äî Computer Information Technology (Excelsior ‚úì)','SUNY Canton ‚Äî Computer Information Systems'],
    jobs:['IT Support Specialist ‚Äî $50K','Junior Web Developer ‚Äî $65K','Cybersecurity Analyst ‚Äî $80K','Data Analyst ‚Äî $70K','Network Administrator ‚Äî $72K'],
  },
  health:{label:'Healthcare & Medicine',icon:'üè•',salary:'$50K‚Äì$100K',
    certifications:['CNA (Certified Nursing Assistant) ‚Äî 6 weeks training, immediate hire','EMT Basic Certification ‚Äî 120 hours, NYC Fire Dept pipeline','Phlebotomy Technician Certification ‚Äî 4‚Äì8 weeks','Medical Assistant Certification (CCMA) ‚Äî 6 months','CPR/First Aid ‚Äî required for ALL health careers, get it now'],
    programs:[
      {name:'NYC Health + Hospitals CNA Training',link:'https://www.nychealthandhospitals.org',note:'Free CNA training for NYC residents. Strong pipeline to nursing jobs at city hospitals.'},
      {name:'CUNY Pathways to Healthcare',link:'https://www.cuny.edu',note:'Nursing and Health Sciences at BMCC, City Tech, Lehman ‚Äî free with Excelsior for eligible students.'},
      {name:'NYC CTE Health Science Programs',link:'https://www.schools.nyc.gov/learning/student-journey/career-connected-learning/career-and-technical-education-cte/',note:'80+ Health Science CTE programs in NYC: medical terminology, anatomy, clinical rotations.'},
      {name:'NYAS Junior Academy ‚Äî Science Track',link:'https://www.nyas.org/learning/high-school-research-programs/high-school-resources/',note:'Free virtual mentorship with real scientists and doctors. Strengthens college AND job applications.'},
      {name:'SYEP ‚Äî Health Track',link:'https://www.nyc.gov/site/dycd/services/jobs-internships/summer-youth-employment-program-syep.page',note:'Paid placements at NYC hospitals, clinics, and health agencies. Ages 14‚Äì24. Apply in January.'},
    ],
    colleges:['CUNY BMCC ‚Äî Nursing, Health Info Technology (Excelsior ‚úì)','CUNY Lehman ‚Äî Nursing (Excelsior ‚úì)','CUNY City Tech ‚Äî Dental Hygiene, Radiologic Technology (Excelsior ‚úì)','SUNY Downstate ‚Äî Nursing, Health Sciences'],
    jobs:['CNA ‚Äî $38K (growing fastest in NYC)','Medical Assistant ‚Äî $42K','EMT ‚Äî $50K','Phlebotomist ‚Äî $40K','Registered Nurse ‚Äî $85K with associate degree'],
  },
  business:{label:'Business & Finance',icon:'üíº',salary:'$50K‚Äì$85K',
    certifications:['Microsoft Excel Specialist (MOS) ‚Äî most requested by employers','QuickBooks ProAdvisor ‚Äî free online, used in every small business','Google Analytics Certification ‚Äî free, used in marketing jobs','HubSpot Marketing Certification ‚Äî free, 6 hours','FINRA SIE Exam ‚Äî entry point for financial industry careers'],
    programs:[
      {name:'CUNY Small Business Development Center',link:'https://www.cuny.edu',note:'Free business courses and mentorship at CUNY campuses. Great for entrepreneurship and business admin.'},
      {name:'NYC Business Solutions ‚Äî Free Training',link:'https://www.nyc.gov/businesssolutions',note:'Free accounting, Excel, business admin certification programs for NYC residents.'},
      {name:'NYC CTE Business & Finance Programs',link:'https://www.schools.nyc.gov/learning/student-journey/career-connected-learning/career-and-technical-education-cte/',note:'Accounting, entrepreneurship, marketing, banking CTE programs across NYC high schools.'},
      {name:'SYEP ‚Äî Business & Corporate Track',link:'https://www.nyc.gov/site/dycd/services/jobs-internships/summer-youth-employment-program-syep.page',note:'Paid summer placements at NYC corporations, nonprofits, financial firms. Ages 14‚Äì24.'},
      {name:'Raise.me ‚Äî Micro Scholarships',link:'https://www.raise.me',note:'Start in 9th grade earning micro-scholarships for GPA and activities. Redeemable at 300+ colleges.'},
    ],
    colleges:['CUNY Baruch College ‚Äî #1 CUNY for business, Forbes Top 20 public (Excelsior ‚úì)','CUNY BMCC ‚Äî Business Administration (Excelsior ‚úì)','CUNY Brooklyn College ‚Äî Business (Excelsior ‚úì)','SUNY Buffalo ‚Äî Business School'],
    jobs:['Bookkeeper ‚Äî $45K','Marketing Coordinator ‚Äî $50K','Financial Analyst ‚Äî $70K','Accountant ‚Äî $65K','Business Analyst ‚Äî $72K','Operations Manager ‚Äî $75K'],
  },
  law:{label:'Law & Criminal Justice',icon:'‚öñÔ∏è',salary:'$48K‚Äì$90K',
    certifications:['Paralegal Certificate (CUNY ‚Äî 1 year program)','Court Interpreter Certification (NYS ‚Äî if bilingual this is extremely valuable)','Security Guard License (NYS ‚Äî quick entry-level path)','Mediation & Conflict Resolution Certificate','Social Work Assistant Certification (CUNY)'],
    programs:[
      {name:'Legal Outreach ‚Äî Law Career Prep',link:'https://www.legaloutreach.org',note:'Free program for NYC public school students: college access + law career prep. Mock trials, internships. Based in Brooklyn.'},
      {name:'CUNY Law School Pipeline',link:'https://www.law.cuny.edu',note:'CUNY Law is the most affordable law school in the US. Pipeline programs for high school students exist.'},
      {name:'NYC Dept of Probation ‚Äî YouthConnect',link:'https://www.nyc.gov/site/probation/individuals/youthconnect.page',note:'Mentorship + career development for NYC youth interested in criminal justice and social services.'},
      {name:'NYC CTE Law & Government Programs',link:'https://www.schools.nyc.gov/learning/student-journey/career-connected-learning/career-and-technical-education-cte/',note:'Law, public safety, government CTE across NYC ‚Äî mock trials, court visits, internships included.'},
      {name:'SYEP ‚Äî Government & Nonprofit Track',link:'https://www.nyc.gov/site/dycd/services/jobs-internships/summer-youth-employment-program-syep.page',note:'Placements at city agencies, courts, law firms, nonprofits. Real legal environment. Ages 14‚Äì24.'},
    ],
    colleges:['CUNY John Jay College ‚Äî Criminal Justice, Law (#1 in US for this field, Excelsior ‚úì)','CUNY Hunter ‚Äî Urban Policy, Sociology, Social Work (Excelsior ‚úì)','CUNY Lehman ‚Äî Political Science, Social Work (Excelsior ‚úì)','SUNY Albany ‚Äî Criminal Justice'],
    jobs:['Paralegal ‚Äî $52K','Social Worker ‚Äî $55K','Court Officer ‚Äî $72K + city pension','Probation Officer ‚Äî $58K','Community Organizer ‚Äî $48K','Lawyer ‚Äî $85K+ (after law school)'],
  },
};

function toggleCTE(val, el) {
  cteIndustry = val;
  document.querySelectorAll('#cte1 .subj-card').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected');
  document.getElementById('cte1Next').disabled = false;
}

function setCTEGoal(val, el) {
  cteGoal = val;
  document.querySelectorAll('#cte2 .subj-card').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected');
  document.getElementById('cte2Next').disabled = false;
}

function buildCTEResults() {
  const cte = CTE_DATA[cteIndustry]; if(!cte) return;
  let html = `<button class="btn-back-flow" onclick="goTo('cte2')">‚Üê Back</button>
  <div class="result-hero">
    <div class="result-emoji">${cte.icon}</div>
    <div class="result-title">${cte.label} Pathways</div>
    <div class="result-sub">Real programs ¬∑ Real certifications ¬∑ Real salaries ‚Äî no 4-year degree required for most.</div>
  </div>`;

  html += `<div style="background:var(--black);border-radius:16px;padding:18px;margin-bottom:14px;color:white">
    <div style="font-size:11px;font-weight:800;color:var(--teal);margin-bottom:6px;text-transform:uppercase;letter-spacing:0.5px">üí° The honest truth about CTE</div>
    <div style="font-size:13px;color:#cbd5e1;line-height:1.7">A CTE certification + 2 years experience can pay <strong style="color:white">more than a 4-year degree</strong> in ${cte.label}. NYC hires heavily from CTE and associate degree programs ‚Äî union jobs, city government, healthcare, and tech all have strong pipelines. You do <em style="color:white">not</em> need to go into debt for a great career.</div>
  </div>`;

  html += `<div class="panel" style="margin-bottom:14px">
    <div class="panel-title">üí∞ Jobs you can get ‚Äî starting salaries</div>
    <div style="display:flex;flex-wrap:wrap;gap:8px">${cte.jobs.map(j=>`<div style="background:var(--teal-light);border-radius:8px;padding:7px 12px;font-size:12px;font-weight:700;color:var(--teal-dark)">${j}</div>`).join('')}</div>
  </div>`;

  html += `<div class="panel" style="margin-bottom:14px">
    <div class="panel-title">üèÖ Certifications to earn in high school</div>
    <div style="font-size:12px;color:var(--gray);margin-bottom:10px">Put these on your resume immediately. Most are free or low-cost for students.</div>
    ${cte.certifications.map((c,i)=>`<div class="study-item"><div class="sdot ${i<2?'red':'yellow'}"></div><div><div class="study-name">${c}</div></div></div>`).join('')}
  </div>`;

  html += `<div class="panel" style="margin-bottom:14px">
    <div class="panel-title">üè´ NYC Programs ‚Äî apply now</div>
    ${cte.programs.map(p=>`<div class="study-item"><div class="sdot green"></div><div>
      <div class="study-name">${p.name}</div>
      <div style="font-size:11px;color:var(--gray);margin:2px 0 4px">${p.note}</div>
      <a href="${p.link}" target="_blank" class="study-link">Learn more ‚Üí</a>
    </div></div>`).join('')}
  </div>
  <div class="panel" style="margin-bottom:14px">
    <div class="panel-title">üîó Explore All CTE Options</div>
    <div style="font-size:12px;color:var(--gray);margin-bottom:10px">Official NYC and NY State resources for CTE programs and pathways.</div>
    <div class="study-item"><div class="sdot green"></div><div>
      <div class="study-name">NYC DOE ‚Äî Career & Technical Education</div>
      <div style="font-size:11px;color:var(--gray);margin:2px 0 4px">Browse all CTE programs in NYC public schools by industry and school</div>
      <a href="https://www.schools.nyc.gov/learning/student-journey/career-connected-learning/career-and-technical-education-cte/" target="_blank" class="study-link">Browse programs ‚Üí</a>
    </div></div>
    <div class="study-item"><div class="sdot green"></div><div>
      <div class="study-name">NYSED ‚Äî Career & Technical Education</div>
      <div style="font-size:11px;color:var(--gray);margin:2px 0 4px">NY State standards, approved programs, and CTE credentials recognized by employers</div>
      <a href="https://www.nysed.gov/career-technical-education" target="_blank" class="study-link">See NY State programs ‚Üí</a>
    </div></div>
    <div class="study-item"><div class="sdot green"></div><div>
      <div class="study-name">Growing Up NYC ‚Äî CTE Programs</div>
      <div style="font-size:11px;color:var(--gray);margin:2px 0 4px">City-wide guide to CTE programs for NYC youth ‚Äî searchable by interest</div>
      <a href="https://growingupnyc.cityofnewyork.us/programs/career-technical-education/" target="_blank" class="study-link">Find a program ‚Üí</a>
    </div></div>
  </div>`;

  if (cteGoal !== 'job') {
    html += `<div class="panel" style="margin-bottom:14px">
      <div class="panel-title">üèõÔ∏è Best CUNY/SUNY for ${cte.label}</div>
      <div style="font-size:12px;color:var(--gray);margin-bottom:10px">Associate degrees (2 years) are often free with Excelsior. Transfer to 4-year later if you want.</div>
      ${cte.colleges.map(c=>`<div class="study-item"><div class="sdot green"></div><div><div class="study-name">${c}</div></div></div>`).join('')}
      <a href="https://www.hesc.ny.gov" target="_blank" class="study-link" style="display:inline-block;margin-top:8px">Apply for Excelsior free tuition ‚Üí</a>
    </div>`;
  }
  document.getElementById('s4').querySelector('.flow-section').innerHTML = html;
  buildResultsCommon(); goTo('s4');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// COLLEGE ADMISSIONS FLOW
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let colGrade = null;

const COLLEGE_DATA = {
  '9':{title:'9th Grade ‚Äî Start strong now',urgent:null,cuny_tip:'You have 3 years. Focus on GPA and activities ‚Äî CUNY is affordable and Excelsior covers tuition if family earns under $125K.',
    checklist:[
      {task:'Sign up for Raise.me ‚Äî earn micro-scholarships for your GPA starting TODAY',link:'https://www.raise.me',hot:true},
      {task:'Start a basic resume ‚Äî even one activity or volunteer experience counts',link:'resume.html',hot:false},
      {task:'Ask your counselor about CUNY College Now ‚Äî take free college classes while in HS',link:'https://www.cuny.edu/about/administration/offices/k16/college-now/',hot:false},
      {task:'Explore NYC CTE programs ‚Äî a pathway can strengthen your profile and your options',link:'https://www.schools.nyc.gov/learning/student-journey/career-connected-learning/career-and-technical-education-cte/',hot:false},
      {task:'Learn about the Portrait of a Graduate ‚Äî changing NYC graduation requirements by 2027',link:'https://www.nysed.gov/next-generation-learning-standards',hot:false},
    ]},
  '10':{title:'10th Grade ‚Äî Build momentum',urgent:'üìÖ October: Take the PSAT ‚Äî free at your school and unlocks a personalized RegentsPrep SAT plan!',cuny_tip:'Sophomore year is the best time to visit CUNY campuses. Most are free to tour. Knowing your target school makes senior year much less stressful.',
    checklist:[
      {task:'Take the PSAT this October ‚Äî free, gives you a personalized SAT prep roadmap from Khan',link:'https://satsuite.collegeboard.org/digital/digital-practice-preparation/practice-tests',hot:true},
      {task:'Raise.me ‚Äî still earning micro-scholarships for GPA, volunteer hours, activities',link:'https://www.raise.me',hot:true},
      {task:'Visit 1‚Äì2 CUNY campuses ‚Äî free tours. Start with Baruch, City Tech, or Hunter',link:'https://www.cuny.edu',hot:false},
      {task:'CUNY College Now ‚Äî take a free college credit class this summer at a CUNY campus',link:'https://www.cuny.edu/about/administration/offices/k16/college-now/',hot:false},
      {task:'Update your activities list ‚Äî clubs, jobs, volunteer, sports. Colleges want growth over time',link:'resume.html',hot:false},
    ]},
  '11':{title:'11th Grade ‚Äî The most important year',urgent:'‚ö†Ô∏è THIS IS YOUR MOST IMPORTANT YEAR. Colleges see 9th‚Äì11th grade transcripts. Every grade counts now.',cuny_tip:'CUNY has rolling admissions ‚Äî apply early. Baruch and Hunter are competitive. BMCC, Queensborough, and Bronx CC have open access.',
    checklist:[
      {task:'Register for SAT this spring at collegeboard.org. Study NOW using RegentsPrep',link:'https://satsuite.collegeboard.org/digital/digital-practice-preparation/practice-tests',hot:true},
      {task:'CUNY application opens Nov 1 ‚Äî know your target campuses and programs NOW',link:'https://www.cuny.edu/admissions/undergraduate/',hot:true},
      {task:'FAFSA opens Dec 1 ‚Äî file ASAP. Earlier = more financial aid. studentaid.gov',link:'https://studentaid.gov',hot:true},
      {task:'Apply for Excelsior Scholarship at hesc.ny.gov ‚Äî family under $125K = free CUNY tuition',link:'https://www.hesc.ny.gov',hot:true},
      {task:'Visit NYC College Access Center ‚Äî free 1-on-1 help with applications and FAFSA',link:'https://www.schools.nyc.gov/enrollment/high-school/college-access-centers',hot:false},
      {task:'Request teacher rec letters BEFORE summer ‚Äî give teachers 6 weeks minimum',link:null,hot:false},
      {task:'Start Common App college essays in July ‚Äî topics release in August each year',link:'https://www.commonapp.org',hot:false},
    ]},
  '12':{title:'12th Grade ‚Äî Deadlines are NOW',urgent:'üö® DO NOT WAIT. Every week you delay costs money. File FAFSA and CUNY application today.',cuny_tip:'Most students underestimate CUNY. Baruch is a Top 20 public business school. CUNY Law is the most affordable law school in the US. Your NY residency is a financial asset ‚Äî use it.',
    checklist:[
      {task:'CUNY Application: Apply at cuny.edu RIGHT NOW ‚Äî rolling admissions, earlier = better aid',link:'https://www.cuny.edu/admissions/undergraduate/',hot:true},
      {task:'FAFSA: File TODAY at studentaid.gov ‚Äî every week late = less money available',link:'https://studentaid.gov',hot:true},
      {task:'Excelsior Scholarship deadline: June 30 ‚Äî apply at hesc.ny.gov before it closes',link:'https://www.hesc.ny.gov',hot:true},
      {task:'Common App ‚Äî apply to 2‚Äì3 SUNY schools as affordable in-state backups',link:'https://www.commonapp.org',hot:false},
      {task:'NYC College Access Center ‚Äî free help with applications, essays, FAFSA appeals',link:'https://www.schools.nyc.gov/enrollment/high-school/college-access-centers',hot:false},
      {task:'Apply to 5+ scholarships on Fastweb and Bold.org ‚Äî 30 min each, adds up fast',link:'https://www.fastweb.com',hot:false},
      {task:'Compare financial aid offers carefully ‚Äî CUNY + Excelsior often beats a partial scholarship elsewhere',link:null,hot:false},
    ]},
};

const CUNY_SCHOOLS = [
  {name:'Baruch College',focus:'Business, Finance, Public Affairs',sel:'Competitive (GPA 3.5+)',link:'https://www.baruch.cuny.edu',ex:true},
  {name:'Hunter College',focus:'Pre-Med, Education, Social Sciences',sel:'Competitive (GPA 3.3+)',link:'https://www.hunter.cuny.edu',ex:true},
  {name:'Brooklyn College',focus:'Liberal Arts, Business, Science',sel:'Moderate (GPA 3.0+)',link:'https://www.brooklyn.cuny.edu',ex:true},
  {name:'City College (CCNY)',focus:'Engineering, Architecture, Sciences',sel:'Moderate (GPA 3.0+)',link:'https://www.ccny.cuny.edu',ex:true},
  {name:'CUNY City Tech',focus:'Technology, Nursing, Design',sel:'Open access',link:'https://www.citytech.cuny.edu',ex:true},
  {name:'BMCC',focus:'Liberal Arts, Business, Nursing (transfer)',sel:'Open access',link:'https://www.bmcc.cuny.edu',ex:true},
  {name:'John Jay College',focus:'Criminal Justice, Law, Public Service',sel:'Moderate',link:'https://www.jjay.cuny.edu',ex:true},
  {name:'SUNY Stony Brook',focus:'STEM, Medicine, Research',sel:'Competitive',link:'https://www.stonybrook.edu',ex:false},
  {name:'SUNY Buffalo',focus:'Engineering, Business, Pre-Med',sel:'Moderate',link:'https://www.buffalo.edu',ex:false},
  {name:'SUNY New Paltz',focus:'Arts, Education, Business',sel:'Moderate',link:'https://www.newpaltz.edu',ex:false},
];

function setColGrade(val, el) {
  colGrade = val;
  document.querySelectorAll('#col1 .subj-card').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected');
  document.getElementById('col1Next').disabled = false;
}

function buildCollegeResults() {
  const data = COLLEGE_DATA[colGrade]; if(!data) return;
  let html = `<button class="btn-back-flow" onclick="goTo('col1')">‚Üê Back</button>
  <div class="result-hero">
    <div class="result-emoji">üéì</div>
    <div class="result-title">${data.title}</div>
    <div class="result-sub">NY-first college roadmap ‚Äî CUNY and SUNY are world-class and affordable.</div>
  </div>`;

  if (data.urgent) html += `<div style="background:#fff1f2;border:1.5px solid #dc2626;border-radius:14px;padding:14px 16px;margin-bottom:14px;font-size:13px;font-weight:700;color:#dc2626">${data.urgent}</div>`;

  html += `<div style="background:var(--teal-light);border:1.5px solid var(--teal);border-radius:14px;padding:14px 16px;margin-bottom:14px">
    <div style="font-size:11px;font-weight:800;text-transform:uppercase;letter-spacing:0.5px;color:var(--teal);margin-bottom:4px">üèõÔ∏è CUNY Tip ‚Äî ${colGrade}th Grade</div>
    <div style="font-size:13px;color:#0b5e44;line-height:1.6">${data.cuny_tip}</div>
  </div>`;

  html += `<div class="panel" style="margin-bottom:14px">
    <div class="panel-title">‚úÖ Your ${colGrade}th Grade College Checklist</div>
    ${data.checklist.map(item=>`<div class="study-item">
      <div class="sdot ${item.hot?'red':'green'}"></div><div>
        <div class="study-name">${item.hot?'üî¥ ':''}<strong>${item.task}</strong></div>
        ${item.link?`<a href="${item.link}" target="_blank" class="study-link">Do this now ‚Üí</a>`:''}
      </div>
    </div>`).join('')}
  </div>`;

  html += `<div class="panel" style="margin-bottom:14px">
    <div class="panel-title">üèõÔ∏è Top CUNY & SUNY Schools ‚Äî NY-First</div>
    <div style="font-size:12px;color:var(--gray);margin-bottom:12px">Excelsior covers tuition at all CUNY schools if family earns under $125K/year.</div>
    ${CUNY_SCHOOLS.map(s=>`<div class="study-item"><div class="sdot ${s.ex?'green':'yellow'}"></div><div>
      <div class="study-name">${s.name} ${s.ex?'<span style="font-size:10px;background:var(--teal-light);color:var(--teal);padding:2px 7px;border-radius:10px;font-weight:700">Excelsior ‚úì</span>':''}</div>
      <div style="font-size:11px;color:var(--gray);margin:2px 0 4px">${s.focus} ¬∑ ${s.sel}</div>
      <a href="${s.link}" target="_blank" class="study-link">Visit website ‚Üí</a>
    </div></div>`).join('')}
  </div>`;

  html += `<div class="panel" style="margin-bottom:14px">
    <div class="panel-title">üìÖ Key Deadlines Every Year</div>
    ${[
      {date:'October',task:'Take PSAT ‚Äî free at your school',hot:false},
      {date:'Nov 1',task:'CUNY application opens',hot:true},
      {date:'Dec 1',task:'FAFSA opens ‚Äî file IMMEDIATELY',hot:true},
      {date:'Jan‚ÄìMar',task:'SAT test dates ‚Äî register 6 weeks early',hot:false},
      {date:'Feb 15',task:'CUNY priority deadline for fall',hot:true},
      {date:'April',task:'Compare all financial aid offers',hot:false},
      {date:'May 1',task:'National decision deadline ‚Äî commit to your school',hot:false},
      {date:'June 30',task:'Excelsior Scholarship deadline at hesc.ny.gov',hot:true},
    ].map(d=>`<div class="study-item"><div class="sdot ${d.hot?'red':'green'}"></div><div>
      <div style="font-size:11px;font-weight:800;color:var(--gray);text-transform:uppercase">${d.date}</div>
      <div class="study-name">${d.hot?'üî¥ ':''}<strong>${d.task}</strong></div>
    </div></div>`).join('')}
  </div>`;

  document.getElementById('s4').querySelector('.flow-section').innerHTML = html;
  buildResultsCommon(); goTo('s4');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SHARED: append resource browser + intercept clicks
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function buildResultsCommon() {
  const section = document.getElementById('s4').querySelector('.flow-section');
  section.insertAdjacentHTML('beforeend',`<div class="res-browser" style="margin-top:14px">
    <div class="res-browser-head"><div>
      <div class="res-browser-label">üìö Resources for you</div>
      <div class="res-browser-title">Find your next opportunity</div>
    </div><a onclick="window.open('resources.html','_blank')" href="#" class="res-see-all">See all ‚Üí</a></div>
    <div class="res-pills" id="resPills">
      <button class="res-pill active" onclick="filterRes('all',this)">All</button>
      <button class="res-pill" onclick="filterRes('internship',this)">‚òÄÔ∏è Internships</button>
      <button class="res-pill" onclick="filterRes('scholarship',this)">üèÜ Scholarships</button>
      <button class="res-pill" onclick="filterRes('sat',this)">üìù SAT/ACT</button>
      <button class="res-pill" onclick="filterRes('college',this)">üéì College</button>
      <button class="res-pill" onclick="filterRes('study',this)">üìö Self-Study</button>
    </div>
    <div class="res-grid" id="resGrid"></div>
    <a onclick="window.open('resources.html','_blank')" href="#" class="res-full-btn">Browse all 26+ resources ‚Üí</a>
  </div>`);
  setTimeout(()=>{
    renderResGrid();
  },50);
}

function filterRes(cat, btn) {
  activeResCat = cat;
  document.querySelectorAll('.res-pill').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderResGrid();
  track('resource_filter', {cat});
}
function renderResGrid() {
  const filtered = activeResCat==='all' ? RES : RES.filter(r=>r.cat===activeResCat);
  document.getElementById('resGrid').innerHTML = filtered.slice(0,6).map(r=>`
    <a href="${r.url}" target="_blank" class="rc" onclick="track('resource_click',{name:'${r.name}',cat:'${r.cat}'})">
      <div class="rc-icon">${r.icon}</div>
      <div class="rc-name">${r.name}</div>
      <div class="rc-tags">${r.tags.map(t=>{const cls=t==='hot'?'hot':t==='paid'?'paid':t==='stem'?'stem':'free';const lbl=t==='hot'?'‚ö° Apply now':t==='paid'?'üí∞ Paid':t==='stem'?'STEM':'Free';return '<span class="rc-tag '+cls+'">'+lbl+'</span>';}).join('')}</div>
    </a>`).join('');
}
renderResGrid();

// ======================================
// SUPABASE AUTH
// ======================================
var _sb = null;
function getSB() {
  if (!_sb && typeof supabase !== 'undefined') {
    _sb = supabase.createClient('https://spkqmhrogykcbrvujgub.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNwa3FtaHJvZ3lrY2JydnVqZ3ViIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE3OTU0OTEsImV4cCI6MjA4NzM3MTQ5MX0.00fS4NTvcC4f-mD8gRSqD1huWIdHo8Xe6UMZn8UJeb0');
  }
  return _sb;
}

var currentUser = null;
var pendingPlanData = null;

function initAuth() {
  var sb = getSB();
  if (!sb) return;
  sb.auth.getSession().then(function(r) {
    if (r.data && r.data.session && r.data.session.user) {
      currentUser = r.data.session.user;
      updateNavForUser(currentUser);
    }
  });
  sb.auth.onAuthStateChange(function(event, session) {
    if (event === 'SIGNED_IN' && session && session.user) {
      currentUser = session.user;
      updateNavForUser(currentUser);
      if (pendingPlanData) {
        savePlanToSupabase(pendingPlanData).then(function(ok) {
          pendingPlanData = null;
          if (ok) showAuthSuccess('Your study plan has been saved!');
        });
      }
    } else if (event === 'SIGNED_OUT') {
      currentUser = null;
      updateNavForLogout();
    }
  });
}

function updateNavForUser(user) {
  var signin = document.querySelector('.nav-signin');
  if (!signin) return;
  var name = (user.user_metadata && user.user_metadata.full_name) || (user.email && user.email.split('@')[0]) || 'My plan';
  signin.textContent = 'Hi, ' + name;
  signin.href = 'app.html';
  signin.style.background = 'var(--green)';
  signin.style.color = '#fff';
  signin.style.borderColor = 'var(--green)';
}

function updateNavForLogout() {
  var signin = document.querySelector('.nav-signin');
  if (!signin) return;
  signin.textContent = 'Sign in';
  signin.href = 'app.html';
  signin.style.background = '';
  signin.style.color = '';
  signin.style.borderColor = '';
}

function savePlanToSupabase(planData) {
  var sb = getSB();
  if (!sb || !currentUser) return Promise.resolve(false);
  return sb.from('student_plans').insert({
    user_id: currentUser.id,
    goals: planData.goals,
    subject: planData.subject || null,
    results: planData.results
  }).then(function(r) { return !r.error; });
}

function saveOrPromptSignup(planData) {
  if (currentUser) {
    savePlanToSupabase(planData).then(function(ok) {
      if (ok) showSavedToast('Plan saved to your account');
    });
  } else {
    pendingPlanData = planData;
    openSignupModal();
  }
}

function showSavedToast(msg) {
  var t = document.createElement('div');
  t.textContent = msg;
  t.style.cssText = 'position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:#0d0d0d;color:white;padding:12px 24px;border-radius:100px;font-size:13px;font-weight:600;z-index:9999;white-space:nowrap';
  document.body.appendChild(t);
  setTimeout(function() { t.remove(); }, 3000);
}

function openSignupModal() {
  var modal = document.getElementById('signupModal');
  if (!modal) return;
  modal.style.display = 'flex';
  document.body.style.overflow = 'hidden';
  showAuthChoose();
}

function closeModal() {
  var modal = document.getElementById('signupModal');
  if (modal) modal.style.display = 'none';
  document.body.style.overflow = '';
}

function showAuthChoose() {
  document.getElementById('authViewChoose').style.display = 'block';
  document.getElementById('authViewEmail').style.display = 'none';
  document.getElementById('authViewSuccess').style.display = 'none';
}

function showAuthEmail(mode) {
  document.getElementById('authViewChoose').style.display = 'none';
  document.getElementById('authViewEmail').style.display = 'block';
  document.getElementById('authViewSuccess').style.display = 'none';
  document.getElementById('authEmailTitle').textContent = mode === 'login' ? 'Welcome back' : 'Create your account';
  var btn = document.getElementById('authSubmitBtn');
  btn.textContent = mode === 'login' ? 'Sign in' : 'Create account';
  btn.dataset.mode = mode;
  document.getElementById('authError').style.display = 'none';
  document.getElementById('authEmail').value = '';
  document.getElementById('authPassword').value = '';
  setTimeout(function() { document.getElementById('authEmail').focus(); }, 100);
}

function showAuthSuccess(msg) {
  document.getElementById('authViewChoose').style.display = 'none';
  document.getElementById('authViewEmail').style.display = 'none';
  document.getElementById('authViewSuccess').style.display = 'block';
  document.getElementById('authSuccessMsg').textContent = msg || 'Your study plan has been saved.';
}

function submitAuth() {
  var sb = getSB();
  if (!sb) return;
  var email = document.getElementById('authEmail').value.trim();
  var password = document.getElementById('authPassword').value;
  var mode = document.getElementById('authSubmitBtn').dataset.mode || 'signup';
  var errEl = document.getElementById('authError');
  var btn = document.getElementById('authSubmitBtn');

  if (!email || !password) { errEl.textContent = 'Please enter your email and password.'; errEl.style.display = 'block'; return; }
  if (password.length < 6) { errEl.textContent = 'Password must be at least 6 characters.'; errEl.style.display = 'block'; return; }

  btn.textContent = 'Please wait...';
  btn.disabled = true;
  errEl.style.display = 'none';

  var promise = mode === 'signup'
    ? sb.auth.signUp({ email: email, password: password })
    : sb.auth.signInWithPassword({ email: email, password: password });

  promise.then(function(result) {
    if (result.error) {
      var msg = result.error.message
        .replace('Invalid login credentials', 'Wrong email or password.')
        .replace('User already registered', 'Account exists ‚Äî sign in instead.')
        .replace('Password should be at least 6 characters', 'Password needs 6+ characters.');
      errEl.textContent = msg;
      errEl.style.display = 'block';
      btn.textContent = mode === 'login' ? 'Sign in' : 'Create account';
      btn.disabled = false;
      return;
    }
    if (mode === 'signup' && result.data && result.data.user && !result.data.session) {
      showAuthSuccess('Check your email to confirm your account, then sign back in!');
      return;
    }
    track(mode === 'signup' ? 'signup_completed' : 'login_completed', { email: email });
  }).catch(function() {
    errEl.textContent = 'Something went wrong. Please try again.';
    errEl.style.display = 'block';
    btn.textContent = mode === 'login' ? 'Sign in' : 'Create account';
    btn.disabled = false;
  });
}

function signInWithGoogle() {
  var sb = getSB();
  if (!sb) return;
  sb.auth.signInWithOAuth({
    provider: 'google',
    options: { redirectTo: window.location.origin + (window.location.pathname.includes('/zened/') ? '/zened/' : '/') + 'app.html' }
  }).then(function(r) {
    if (r.error) {
      var errEl = document.getElementById('authError');
      errEl.textContent = 'Google sign-in unavailable. Use email instead.';
      errEl.style.display = 'block';
    }
  });
}

function continueWithoutSaving() {
  closeModal();
  pendingPlanData = null;
  track('signup_skipped', {});
  if (pendingUrl) {
    if (pendingUrl.startsWith('http')) window.open(pendingUrl, '_blank');
    else window.location.href = pendingUrl;
    pendingUrl = null;
  }
}

document.addEventListener('keydown', function(e) {
  if (e.key === 'Enter') {
    var emailView = document.getElementById('authViewEmail');
    if (emailView && emailView.style.display !== 'none') submitAuth();
  }
});

window.addEventListener('load', initAuth);



// ‚ïê‚ïê‚ïê FEATURES SECTION ‚ïê‚ïê‚ïê
let featuresOpen = false;
function toggleFeatures() {
  featuresOpen = !featuresOpen;
  const section = document.getElementById('features');
  const btn = document.getElementById('featuresToggleBtn');
  if (featuresOpen) {
    section.style.display = 'block';
    btn.textContent = '‚ú¶ Hide subject features ‚Üë';
    btn.classList.add('open');
    setTimeout(() => section.scrollIntoView({behavior:'smooth', block:'start'}), 50);
  } else {
    section.style.display = 'none';
    btn.textContent = '‚ú¶ See what\'s inside for each subject \u2193';
    btn.classList.remove('open');
  }
}


// ‚îÄ‚îÄ FEATURES TAB SWITCHER ‚îÄ‚îÄ
function fsTab(key, el) {
  document.querySelectorAll('.fs-tab').forEach(t => t.classList.remove('on'));
  document.querySelectorAll('.fs-panel').forEach(p => p.classList.remove('on'));
  el.classList.add('on');
  document.getElementById('fsp-' + key).classList.add('on');
}

// ‚îÄ‚îÄ UNIVERSAL NAV ‚îÄ‚îÄ
function toggleNavSearch() {
  const inp = document.getElementById('navSearchInput');
  inp.classList.toggle('open');
  if (inp.classList.contains('open')) { inp.focus(); }
}
function navSearchGo(e) {
  if (e.key === 'Enter') {
    const q = e.target.value.trim();
    if (q) window.location.href = 'resources.html?q=' + encodeURIComponent(q);
  }
  if (e.key === 'Escape') { e.target.classList.remove('open'); }
}
function navSearchLive(v) {
  // If on resources page, filter live
  if (typeof filterCards === 'function') filterCards(v);
}
// Highlight active nav link
(function(){
  const page = location.pathname.split('/').pop() || 'index.html';
  const map = {'index.html':'nl-home','practice.html':'nl-practice','resources.html':'nl-resources','dashboard.html':'nl-dashboard','mission.html':'nl-mission'};
  const id = map[page];
  if (id) { const el = document.getElementById(id); if(el) el.classList.add('active'); }
})();
// Update sign-in button if logged in (for pages with supabase)
(function(){
  const btn = document.getElementById('navSigninBtn');
  if (!btn) return;
  // Check sessionStorage for quick auth state without supabase
  const name = sessionStorage.getItem('zened_user_name');
  if (name) {
    btn.textContent = name.split(' ')[0] || 'Dashboard';
    btn.href = 'dashboard.html';
    btn.classList.add('loggedin');
  }
})();

// ‚îÄ‚îÄ NAV SEARCH ‚îÄ‚îÄ
const SEARCH_INDEX = [
  // Resources
  {ico:'üíº',name:'SYEP ‚Äî Paid Summer Jobs',desc:'NYC paid summer employment program for ages 14-24',url:'https://www.nyc.gov/site/dycd/services/jobs-internships/summer-youth-employment-program-syep.page'},
  {ico:'‚ùÑÔ∏è',name:'Snow.day ‚Äî 500+ Free Programs',desc:'Search engine for free summer programs, STEM, arts, law',url:'https://snow.day'},
  {ico:'üîß',name:'HK Maker Lab ‚Äî Columbia',desc:'Free 5-week engineering program at Columbia University',url:'https://hkmakerlab.columbia.edu'},
  {ico:'üî¨',name:'NYAS Junior Academy',desc:'Virtual science mentorship from real researchers',url:'https://www.nyas.org/programs/global-stem-alliance/junior-academy/'},
  {ico:'üß¨',name:'NYC Science Research Mentoring',desc:'100+ hours at AMNH, Cold Spring Harbor, NY Botanical Garden',url:'https://scienceresearchmentoring.org'},
  {ico:'üß†',name:'BrainYAC ‚Äî Columbia Neuroscience',desc:'Free brain science program for high school students',url:'https://zuckermaninstitute.columbia.edu/brainyac'},
  {ico:'üéì',name:'CUNY Excelsior ‚Äî Free Tuition',desc:'Families under $125k may attend CUNY for free',url:'https://www.hesc.ny.gov'},
  {ico:'üìã',name:'FAFSA ‚Äî Federal Student Aid',desc:'File for free federal financial aid ‚Äî Pell Grants up to $7,395',url:'https://studentaid.gov'},
  {ico:'üèÜ',name:'Fastweb ‚Äî 1.5M Scholarships',desc:'Largest free scholarship database',url:'https://www.fastweb.com'},
  {ico:'‚ú®',name:'Bold.org ‚Äî No-Essay Scholarships',desc:'Apply to scholarships with no essay required',url:'https://bold.org'},
  {ico:'üìà',name:'Raise.me ‚Äî Earn Scholarships Now',desc:'Earn micro-scholarships starting in 9th grade',url:'https://www.raise.me'},
  {ico:'üìù',name:'Official SAT Prep ‚Äî Khan Academy',desc:'Free personalized SAT prep linked to your PSAT results',url:'https://www.khanacademy.org/sat'},
  {ico:'üíª',name:'Bluebook ‚Äî Digital SAT Practice',desc:'Full-length practice tests in exact exam format',url:'https://bluebook.collegeboard.org'},
  {ico:'üìä',name:'Free ACT Practice Tests',desc:'Official ACT prep: full tests, score reports',url:'https://www.act.org/content/act/en/products-and-services/the-act/test-preparation/free-act-test-prep.html'},
  {ico:'üèõÔ∏è',name:'NYC College Access Centers',desc:'Free 1-on-1 college counseling across all 5 boroughs',url:'https://www.schools.nyc.gov/enrollment/high-school/college-access-centers'},
  {ico:'üìù',name:'Common App ‚Äî 1,000+ Colleges',desc:'Apply to universities with one application',url:'https://www.commonapp.org'},
  {ico:'üéì',name:'CUNY College Now ‚Äî Free Credits',desc:'Take real CUNY college courses in high school, free',url:'https://www.cuny.edu/about/administration/offices/k16/college-now/'},
  {ico:'üíª',name:'P-TECH ‚Äî Free Associate Degree',desc:'6-year program: diploma + CUNY degree + IBM mentorship',url:'https://www.ptech.org'},
  {ico:'üü¢',name:'Khan Academy ‚Äî All Subjects',desc:'Free lessons for Algebra, ELA, Biology, History, SHSAT',url:'https://www.khanacademy.org'},
  {ico:'üî¨',name:'LabXchange ‚Äî Harvard Science Labs',desc:'Virtual life science labs for grades 9-12, free',url:'https://www.labxchange.org/c/ngss?subject=life-sciences&grade=grades-9-12'},
  {ico:'üìñ',name:'RegentsPrep ‚Äî Past Exams',desc:'Free NY Regents practice for every subject',url:'https://www.regentsprep.org'},
  {ico:'üß™',name:'New Visions Biology Curriculum',desc:'Full free Biology curriculum ‚Äî all 6 units',url:'https://www.newvisions.org/curriculum/science/biology'},
  {ico:'‚öôÔ∏è',name:'NYC CTE Programs',desc:'400+ career and technical programs at NYC high schools',url:'https://www.schools.nyc.gov/learning/programs/career-and-technical-education'},
  {ico:'üåÜ',name:'Growing Up NYC ‚Äî CTE Guide',desc:'City-wide guide to CTE programs, searchable by interest',url:'https://growingupnyc.cityofnewyork.us/programs/career-technical-education/'},
  {ico:'üèÖ',name:'Portrait of a Graduate',desc:"NY's new graduation framework replacing Regents by 2029",url:'https://www.nysed.gov/next-generation-learning-standards'},
  // Pages
  {ico:'üè†',name:'Home ‚Äî Quick Check',desc:'Get your instant readiness score and study plan',url:'index.html'},
  {ico:'üìù',name:'Practice Tests',desc:'Official NYSED past exams and warm-up quizzes',url:'practice.html'},
  {ico:'üìö',name:'Resources',desc:'Browse all scholarships, internships, SAT prep, and more',url:'resources.html'},
  {ico:'üéØ',name:'Mission',desc:"Why we built ZenEd and what we're about",url:'mission.html'},
];

let navSearchOpen = false;

function navSearchToggle() {
  const input = document.getElementById('navSearchInput');
  const wrap = document.getElementById('navSearchWrap');
  navSearchOpen = !navSearchOpen;
  input.classList.toggle('open', navSearchOpen);
  if(navSearchOpen) { input.focus(); }
  else { navSearchClose(); }
}

function navSearchClose() {
  const input = document.getElementById('navSearchInput');
  const results = document.getElementById('navSearchResults');
  input.classList.remove('open');
  results.classList.remove('show');
  input.value = '';
  navSearchOpen = false;
}

function navSearchRun(q) {
  const results = document.getElementById('navSearchResults');
  if(!q || q.length < 2) { results.classList.remove('show'); return; }
  const lower = q.toLowerCase();
  const matches = SEARCH_INDEX.filter(item =>
    item.name.toLowerCase().includes(lower) ||
    item.desc.toLowerCase().includes(lower)
  ).slice(0, 6);
  if(!matches.length) {
    results.innerHTML = '<div class="nsr-empty">No results for "'+q+'"</div>';
    results.classList.add('show');
    return;
  }
  results.innerHTML = matches.map(m =>
    `<a href="${m.url}" class="nsr-item" ${m.url.startsWith('http')?'target="_blank"':''}>
      <div class="nsr-ico">${m.ico}</div>
      <div><div class="nsr-name">${m.name}</div><div class="nsr-desc">${m.desc}</div></div>
    </a>`
  ).join('');
  results.classList.add('show');
}

// Close search on outside click
document.addEventListener('click', e => {
  if(!document.getElementById('navSearchWrap')?.contains(e.target)) navSearchClose();
});
</script>
</body>
</html>
